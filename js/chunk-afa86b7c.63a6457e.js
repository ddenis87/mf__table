(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-afa86b7c"],{"008d":function(e,t,o){},"17ea":function(e,t,o){},5317:function(e,t,o){},"5b7c":function(e,t,o){"use strict";o.d(t,"a",(function(){return s})),o.d(t,"b",(function(){return r})),o.d(t,"c",(function(){return a}));o("99af"),o("c740"),o("ac1f"),o("5319");var n=["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],i=/[A-Z]/gi,l=/[0-9]/g;function s(e){if(e>702)return"Infinity";var t=n.length;if(e<=t){var o=n[e-1];return o}if(e%t===0){var i="".concat(n[(e-t)/t-1]).concat(n[t-1]);return i}var l="".concat(n[Math.floor(e/t)-1]).concat(n[e%t-1]);return l}function r(e){var t=e.toLowerCase();if(1===t.length)return n.findIndex((function(e){return e===t}))+1;var o=n.findIndex((function(e){return e===t[0]}))+1,i=n.findIndex((function(e){return e===t[1]}))+1;return o*n.length+i}function a(e){return{parthSymbol:e.replace(l,""),parthDigit:+e.replace(i,"")}}},6687:function(e,t,o){},"72a8":function(e,t,o){"use strict";o("9662")},7739:function(e,t,o){"use strict";var n=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("table-layout",{attrs:{padding:"4px 4px 4px 4px"}},[o("div",{staticClass:"spread-sheet",style:e.spreadSheetStyle},[o("spread-sheet-angle",{attrs:{"max-column-grouping-level":e.maxColumnGroupingLevel,"max-row-grouping-level":e.maxRowGroupingLevel,"is-show-title":e.isShowTitle},on:{"open-group:column":e.evtOpenGroupColumn,"open-group:row":e.evtOpenGroupRow}}),o("spread-sheet-head",{ref:"SheetHead",attrs:{columns:e.tableColumns,"template-column-width":e.templateColumnWidth,"table-width":e.tableWidth,"max-column-grouping-level":e.maxColumnGroupingLevel,"set-open-group-columns":e.setOpenGroupColumns,"is-show-title":e.isShowTitle},on:{"toggle-group:column":e.toggleColumnGroup}}),o("spread-sheet-body",{ref:"SpreadSheetBody",attrs:{rows:e.tableRows,columns:e.tableColumns,cells:e.tableCells,representations:e.representations,images:e.images,"template-column-width":e.templateColumnWidth,"max-row-grouping-level":e.maxRowGroupingLevel,"max-column-grouping-level":e.maxColumnGroupingLevel,"set-excluded-cells":e.setExcludedCells,"table-width":e.tableWidth,"set-open-group-rows":e.setOpenGroupRows,"is-show-grid":e.isShowGrid,"is-show-title":e.isShowTitle},on:{"click:cell":e.evtClickCell,"dblclick:cell":e.evtDblclickCell,"keydown:cell":e.evtKeydownCell,"buffer:copy":e.evtBufferCopy,"buffer:paste":e.evtBufferPaste,"open-group:row":e.toggleRowGroup,"scroll-body-x":e.scrollBodyX}})],1)])},i=[],l=o("2909"),s=o("5530"),r=o("3835"),a=(o("a9e3"),o("4ec9"),o("d3b7"),o("3ca3"),o("ddb0"),o("159b"),o("4de4"),o("caad"),o("2532"),o("b64b"),o("4fad"),o("99af"),o("b0c0"),o("c7cd"),o("6062"),o("a434"),o("c740"),o("ac1f"),o("5319"),o("5b7c")),u=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"table-layout",style:e.tableLayoutStyle},[e._t("default")],2)},c=[],p={name:"TableLayout",props:{padding:{type:String,default:"0px 0px 0px 0px"}},computed:{tableLayoutStyle:function(){return{padding:this.padding}}}},d=p,h=(o("88c4"),o("2877")),m=Object(h["a"])(d,u,c,!1,null,"7b82dcc5",null),f=m.exports,g=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"spread-sheet__angle",class:e.isShowTitle?"angle":"angle_no-group",style:e.angleStyle},[e.isShowTitle&&e.maxColumnGroupingLevel?o("div",{staticClass:"angle__columnGroup",style:e.columnGroupStyle},e._l(e.maxColumnGroupingLevel,(function(t){return o("div",{key:t,staticClass:"item item_column",attrs:{"data-level":t}},[o("spread-sheet-btn-group",{on:{click:e.evtClickGroupColumn}},[o("span",{staticClass:"btn_text"},[e._v(e._s(t))])])],1)})),0):e._e(),e.isShowTitle&&e.maxRowGroupingLevel?o("div",{staticClass:"angle__rowGroup",style:e.rowGroupStyle},e._l(e.maxRowGroupingLevel,(function(t){return o("div",{key:t,staticClass:"item",attrs:{"data-level":t}},[o("spread-sheet-btn-group",{on:{click:e.evtClickGroupRow}},[o("span",{staticClass:"btn_text"},[e._v(e._s(t))])])],1)})),0):e._e()])},v=[],b=60,y=20,w=22,C=20,x=22,S=94,G=60,O=22,R=20,_=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"spread-sheet-btn-group"},[o("v-btn",{staticClass:"action-btn",attrs:{icon:"",width:"16",height:"16",disabled:e.isDisabled},on:{click:function(t){return e.$emit("click",t)}}},[e._t("default")],2)],1)},B=[],j={name:"SpreadSheetBtnGroup",props:{isDisabled:{type:Boolean,default:!1}}},N=j,L=(o("dd65"),o("6544")),k=o.n(L),E=o("8336"),T=Object(h["a"])(N,_,B,!1,null,"8eb8881a",null),$=T.exports;k()(T,{VBtn:E["a"]});var A={name:"SpreadSheetAngle",components:{SpreadSheetBtnGroup:$},props:{maxRowGroupingLevel:{type:Number,default:0},maxColumnGroupingLevel:{type:Number,default:0},isShowTitle:{type:Boolean,default:!0}},computed:{angleStyle:function(){var e={"grid-template-rows":"1fr ".concat(w-1,"px"),"grid-template-columns":"1fr ".concat(b-2,"px")};return 0===this.maxColumnGroupingLevel&&(e["grid-template-areas"]='"rowGroup rb"',e["grid-template-rows"]="1fr",e["grid-template-columns"]="1fr ".concat(b-2,"px")),this.isShowTitle||(e={"grid-template-rows":"1fr","grid-template-columns":"1fr"}),e},columnGroupStyle:function(){var e={"grid-template-rows":"repeat(".concat(this.maxColumnGroupingLevel,", ").concat(C,"px)")};return e},rowGroupStyle:function(){var e={"grid-template-columns":"repeat(".concat(this.maxRowGroupingLevel,", ").concat(y,"px)"),"grid-template-rows":"".concat(w,"px")};return 0===this.maxColumnGroupingLevel&&(e["padding-top"]="2px",e["align-items"]="flex-start"),e},rbStyle:function(){var e={};return e}},methods:{evtClickGroupColumn:function(e){var t=e.target.closest(".item").getAttribute("data-level");this.$emit("open-group:column",+t)},evtClickGroupRow:function(e){var t=e.target.closest(".item").getAttribute("data-level");this.$emit("open-group:row",+t)}}},M=A,D=(o("ffc3"),Object(h["a"])(M,g,v,!1,null,"6991d391",null)),I=D.exports,F=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"spread-sheet__head",class:{"spread-sheet__head_bottom-line":e.isShowTitle},on:{click:e.eventClickHead}},[e._l(e.maxColumnGroupingLevel,(function(t){return o("div",{key:t,staticClass:"rows rows__group",style:e.templateRowGroup(t)},[e._l(e.columns,(function(n,i){return o("div",{key:i,staticClass:"column column-group",class:e.getGroupClass(t,n,i),style:e.getGroupStyle(t)},[e.isGroup(n,t)?o("spread-sheet-btn-group",{attrs:{"data-column-name":n.name}},[o("v-icon",{attrs:{"x-small":"",color:"black"}},[e._v(" "+e._s(e.setOpenGroupColumns.includes(n.name)?"mdi-minus":"mdi-plus")+" ")])],1):e._e()],1)})),o("div",{staticClass:"column column-group column-end"})],2)})),e.isShowTitle?o("div",{staticClass:"rows rows__title",style:e.templateRow},[e._l(e.columns,(function(t,n){return[o("div",{key:"head-title-"+t.value,staticClass:"column column-title",style:e.getCellStyle(t,n)},[o("div",{staticClass:"content"},[e._v(e._s(t.name.toUpperCase()))])])]})),e._m(0)],2):e._e()],2)},W=[function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"column column-title column-end"},[o("div",{staticClass:"content"})])}],K={name:"SpreadSheetHead",components:{SpreadSheetBtnGroup:$},props:{columns:{type:Array},templateColumnWidth:{type:String,default:""},tableWidth:{type:Number,default:0},maxColumnGroupingLevel:{type:Number,default:0},setOpenGroupColumns:{type:Array,default:function(){return[]}},isShowTitle:{type:Boolean,default:!0}},computed:{templateRow:function(){var e={"grid-template-columns":"".concat(this.templateColumnWidth," 8px"),"grid-template-rows":"".concat(w,"px"),width:"".concat(this.tableWidth,"px")};return e}},methods:{templateRowGroup:function(e){var t=C;e===this.maxColumnGroupingLevel&&(t+=5);var o={"grid-template-columns":"".concat(this.templateColumnWidth," 8px"),"grid-template-rows":"".concat(t,"px"),width:"".concat(this.tableWidth,"px")};return o},eventClickHead:function(e){if(e.target.closest("button")){var t=e.target.closest("button").parentElement.getAttribute("data-column-name");console.log(t),this.$emit("toggle-group:column",t)}},getCellStyle:function(e,t){var o={};if(e.fixed){o.position="sticky",o["z-index"]=100,o.left=0;for(var n=0;n<t;n+=1)o.left+=this.columns[n].width;o.left+="px"}return o},getGroupClass:function(e,t,o){var n=t.level,i=[];return this.setOpenGroupColumns.includes(t.name)&&n===e-1&&i.push("line-start"),e<=n&&i.push("line"),this.isGroupEnd(e,o)&&e<=n&&i.push("line-end"),i},getGroupStyle:function(e){var t={};return e===this.maxColumnGroupingLevel&&(t["border-bottom"]="thin solid grey"),1===e&&(t["border-top"]="thin solid rgb(240, 240, 240)"),t},isGroup:function(e,t){return Object.keys(e).includes("isGroup")&&e.level+1===t},isGroupEnd:function(e,t){var o,n;return(null===(o=this.columns[t+1])||void 0===o?void 0:o.level)!==e&&(null===(n=this.columns[t+1])||void 0===n?void 0:n.level)<=e-1}}},P=K,H=(o("a202"),o("132d")),V=Object(h["a"])(P,F,W,!1,null,"4bd45016",null),z=V.exports;k()(V,{VIcon:H["a"]});var U=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{ref:"TableBody",staticClass:"spread-sheet__body",on:{click:e.evtClickBody,dblclick:e.evtDblClickBody,keydown:e.evtKeydownBody,mousedown:e.evtMousedown}},[o("tooltip",e._b({},"tooltip",e.propsTooltip,!1)),o("div",{ref:"SheetBodyFixed"}),o("virtual-list",{ref:"SheetBody",staticClass:"body-virtual",style:e.styleBody,attrs:{"wrap-style":e.styleWrapRow,keeps:120,"data-key":"value","data-sources":e.rows,"data-component":e.sheetBodyItem,"extra-props":e.propsItemBody},on:{scroll:e.evtScrollList,resized:e.evtResizedList}})],1)},q=[],J=(o("07ac"),o("7db0"),function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("v-tooltip",e._b({attrs:{right:"","content-class":"tooltip-box tooltip-box_body"},on:{click:e.evtClose,mouseover:e.evtClose},model:{value:e.isShow,callback:function(t){e.isShow=t},expression:"isShow"}},"v-tooltip",e.positionTooltip,!1),[e._v(e._s(e.text))])}),X=[],Z={name:"Tooltip",props:{text:{type:String,default:"qwe"},position:{type:Object,default:function(){return{left:-100,top:-100}}},isShow:{type:Boolean,default:!1}},computed:{positionTooltip:function(){return{"position-x":this.position.left,"position-y":this.position.top}}},methods:{evtClose:function(){this.$emit("close")}}},Q=Z,Y=o("3a2f"),ee=Object(h["a"])(Q,J,X,!1,null,"467ae553",null),te=ee.exports;k()(ee,{VTooltip:Y["a"]});var oe=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{key:"body-row-"+e.rowName,staticClass:"sheet-body__row",style:e.gridRow},[e.isShowGroup?e._l(e.maxRowGroupingLevel,(function(t,n){return o("div",{key:n,staticClass:"column column-group",class:e.getGroupClass(t),style:e.getGroupStyle(t)},[e.isGroup(t)?o("spread-sheet-btn-group",{attrs:{"data-row-name":e.rowName}},[o("v-icon",{attrs:{"x-small":"",color:"black"}},[e._v(" "+e._s(e.btnGroup)+" ")])],1):e._e()],1)})):e._e(),e.isShowTitle?o("div",{staticClass:"column column-title",style:e.shiftTitle},[o("div",{staticClass:"content"},[e._v(e._s(e.rowName))])]):e._e(),e._l(e.columns,(function(t,n){return[e.checkCellExclusion(t.name)?o("div",{key:"body-"+e.source.value+"-"+t.value,staticClass:"column column-body",class:e.getCellClass(t.name),style:e.getCellStyle(t.name,n),attrs:{"data-name":e.getCellName(t.name),"data-tooltip":e.getTooltip(t.name),tabindex:n}},[e.hasImg(t.name)?o("div",{staticClass:"content",domProps:{innerHTML:e._s(e.getImg(t.name))}}):o("div",{staticClass:"content",class:{content_tooltip:e.hasTooltip(t.name)},domProps:{innerHTML:e._s(e.formattedData(t.name))}})]):e._e()]}))],2)},ne=[],ie=o("4148"),le={name:"SpreadSheetBodyItem",components:{SpreadSheetBtnGroup:$},props:{cells:{type:Object,default:function(){return{}}},columns:Array,images:{type:Object,default:function(){return{}}},index:{type:Number},isShowGroup:{type:Boolean,default:!0},isShowGrid:{type:Boolean,default:!0},isShowTitle:{type:Boolean,default:!0},maxRowGroupingLevel:{type:Number,default:0},rows:Array,setExcludedCells:{type:Array},setOpenGroupRows:{type:Array,default:function(){return[]}},setRepresentations:{type:Map,default:function(){return new Map}},source:{type:Object,default:function(){return{}}},templateColumnWidth:{type:String,default:""}},data:function(){return{rowName:this.source.value}},computed:{btnGroup:function(){return this.setOpenGroupRows.includes(this.rowName)?"mdi-minus":"mdi-plus"},gridRow:function(){var e={"grid-template-rows":"".concat(this.source.height||O,"px"),"grid-template-columns":this.templateColumnTitle};return e},shiftTitle:function(){var e=R*this.maxRowGroupingLevel;0!==this.maxRowGroupingLevel&&(e+=4);var t={left:"".concat(e,"px")};return 0===this.index&&(t["border-top"]=0),this.index===this.rows.length-1&&(t["border-bottom"]="thin solid grey"),t},templateColumnTitle:function(){var e="".concat(this.templateColumnWidth);return this.isShowTitle&&(e="".concat(G,"px ").concat(e)),0!==this.maxRowGroupingLevel&&(e="repeat(".concat(this.maxRowGroupingLevel-1,",\n                               minmax(").concat(y,"px, ").concat(y,"px))\n                               ").concat(y+4,"px\n                               ").concat(e)),e}},methods:{checkCellExclusion:function(e){var t=this.getCellName(e);return!this.setExcludedCells.includes(t)},formattedData:function(e){var t=this.hasCell(e);return t&&Object.keys(t).includes("value")?ie["a"].formate(t.value,Object(s["a"])(Object(s["a"])({},t),{},{representations:this.setRepresentations})):""},hasCell:function(e){return this.cells[this.getCellName(e)]||!1},hasImg:function(e){var t;return(null===(t=this.hasCell(e))||void 0===t?void 0:t.image)||!1},hasTooltip:function(e){var t;return(null===(t=this.hasCell(e))||void 0===t?void 0:t.title)||!1},isGroup:function(e){return Object.keys(this.source).includes("isGroup")&&this.source.level+1===e},isGroupEnd:function(e){var t,o,n=this.index;return(null===(t=this.rows[n+1])||void 0===t?void 0:t.level)!==this.source.level&&(null===(o=this.rows[n+1])||void 0===o?void 0:o.level)<=e-1},getCellClass:function(e){var t=[];return this.hasCell(e)&&t.push(this.hasCell(e).style||""),this.isShowGrid||t.push("column-body_grid-off"),t},getCellFixed:function(e){var t={};if(this.columns[e].fixed){t.position="sticky",t["z-index"]=100,t.left=R*this.maxRowGroupingLevel,this.isShowTitle&&(t.left+=G);for(var o=0;o<e;o+=1)t.left+=this.columns[o].width;t.left+="px",this.columns[e+1].fixed||this.isShowGrid||(t["box-shadow"]="2px 0px 0px rgba(0, 0, 0, .2)")}return t},getCellGeometry:function(e,t){var o={};if(this.hasCell(e)){var n=this.hasCell(e),i=n["grid-column-start"],l=n["grid-column-end"],s=n.height;o["grid-column-start"]=+i+t,o["grid-column-end"]=+l+t,o.height="".concat(s,"px")}else o["grid-column-start"]=t+(this.maxRowGroupingLevel+2),o["grid-column-end"]=t+(this.maxRowGroupingLevel+2)+1;return this.isShowTitle||(o["grid-column-start"]-=1,o["grid-column-end"]-=1),o},getCellName:function(e){return"".concat(e).concat(this.source.value)},getCellStyle:function(e,t){var o=[];return o.push(this.getCellGeometry(e,t)),o.push(this.getCellFixed(t)),o},getGroupClass:function(e){var t=this.source.level,o=[];return this.setOpenGroupRows.includes(this.rowName)&&t===e-1&&o.push("line-start"),e<=t&&o.push("line"),this.isGroupEnd(e)&&e<=t&&o.push("line-end"),o},getGroupStyle:function(e){var t={left:"".concat(R*(+e-1),"px")};return this.index===this.rows.length-1&&(t["border-bottom"]="thin solid grey"),this.maxRowGroupingLevel===e&&(console.log("add width"),t["border-right"]="thin solid grey",t["padding-right"]="4px",t.width="25px"),t},getImg:function(e){var t;return this.images[null===(t=this.hasCell(e))||void 0===t?void 0:t.image]},getTooltip:function(e){var t;return(null===(t=this.hasCell(e))||void 0===t?void 0:t.title)||""}}},se=le,re=(o("be08"),Object(h["a"])(se,oe,ne,!1,null,"0fa756fa",null)),ae=re.exports;k()(re,{VIcon:H["a"]});var ue={name:"SpreadSheetBody",components:{Tooltip:te},props:{cells:{type:Object},columns:{type:Array},rows:{type:Array},rowsFixed:{type:Array,default:function(){return[]}},tableWidth:{type:Number,default:0},templateColumnWidth:{type:String,default:""},maxRowGroupingLevel:{type:Number,default:0},maxColumnGroupingLevel:{type:Number,default:0},images:{type:Object,default:function(){return{}}},representations:{type:Map,default:function(){return new Map}},setExcludedCells:{type:Object,default:function(){return{}}},setOpenGroupRows:{type:Array,default:function(){return[]}},isShowGrid:{type:Boolean,default:!0},isShowTitle:{type:Boolean,default:!0}},data:function(){return{sheetBodyItem:ae,propsTooltip:{isShow:!1,position:{left:-100,top:-100}},isTooltipTimer:null}},computed:{propsItem:function(){var e;return{columns:this.columns,rows:this.rows,cells:this.cells,"set-representations":this.representations,"set-excluded-cells":(e=[]).concat.apply(e,Object(l["a"])(Object.values(this.setExcludedCells))),"max-row-grouping-level":this.maxRowGroupingLevel,"template-column-width":this.templateColumnWidth,"is-show-grid":this.isShowGrid,"is-show-title":this.isShowTitle}},propsItemBody:function(){return Object(s["a"])(Object(s["a"])({},this.propsItem),{},{"set-open-group-rows":this.setOpenGroupRows,images:this.images})},styleBody:function(){return[this.heightVirtualList,this.widthVirtualList,{"overflow-y":"auto",position:"relative"}]},styleWrapRow:function(){return{position:"relative",width:"".concat(this.tableWidth,"px")}},heightVirtualList:function(){var e=168+this.maxColumnGroupingLevel*C;return 0!==this.maxColumnGroupingLevel&&(e+=4),this.isShowTitle||(e-=x),{height:"calc(100vh - ".concat(e,"px)")}},widthVirtualList:function(){var e=0;this.isShowTitle||(e=this.maxLevelGroupRow*y);var t={width:"calc(100vw - 20px + ".concat(e,"px)")};return t}},mounted:function(){this.sheetBodyGeometry=this.$refs.SheetBody.$el.getBoundingClientRect()},methods:{evtClickBody:function(e){if(e.target.closest("button")){var t=e.target.closest("button").parentElement.getAttribute("data-row-name");this.$emit("open-group:row",+t)}},evtDblClickBody:function(e){if(e.target.hasAttribute("data-name")){var t=e.target.getAttribute("data-name");this.$emit("dblclick:cell",{evt:e,cellName:t})}},evtKeydownBody:function(e){if(!this.isNavigationKey(e)){var t=["Key","Numpad","Digit","Enter","Delete","Space"];if(t.find((function(t){return e.code.includes(t)}))&&!this.isCopyKey(e)&&!this.isPasteKey(e)&&!e.ctrlKey&&(console.log(e.target),e.preventDefault(),e.target.hasAttribute("data-name"))){var o=e.target.getAttribute("data-name");this.$emit("keydown:cell",{evt:e,cellName:o})}}},evtMousedown:function(e){e.target.closest(".column-body")&&(this.selectEnd=null,this.selectStart=e.target);var t=e.target.closest(".column-body");if(t&&t.hasAttribute("data-name")){var o=t.getAttribute("data-name");this.$emit("click:cell",{evt:e,cellName:o});var n=Object.entries(this.cells).find((function(e){return e[0]===o}));if(n){var i=Object(r["a"])(n,2),l=i[1],s=l.noSelect||!1;if(s)return}this.focusCell(this.getCellNodeForName(o))}},evtMouseout:function(){clearTimeout(this.isTooltipTimer),this.propsTooltip.isShow&&(this.propsTooltip={text:"",isShow:!1,position:{left:-100,top:-100}})},evtMouseover:function(e){var t=this;this.isTooltipTimer=setTimeout((function(){var o,n=null===(o=e.target.closest(".column-body"))||void 0===o?void 0:o.getAttribute("data-tooltip");if(n){var i=e.target.closest(".column-body").getBoundingClientRect();t.propsTooltip={text:n,isShow:!0,position:{left:i.right,top:i.top}}}}),300)},evtResizedList:function(){if(this.currentSelectedCellName){var e=this.getCellNodeForName(this.currentSelectedCellName);if(e){var t=e.getBoundingClientRect();t.top>this.sheetBodyGeometry.top-10&&t.bottom<this.sheetBodyGeometry.bottom&&this.focusCell(e)}}},evtScrollList:function(e){this.selectStart=null,this.selectEnd=null,this.$emit("scroll-body-x",e.target.scrollLeft)},focusCell:function(e){e.getBoundingClientRect().left<this.widthFixedArea&&(this.$refs.SheetBody.$el.scrollLeft-=this.widthFixedArea-e.getBoundingClientRect().left+5,this.$refs.SheetBodyFixed.scrollLeft-=this.widthFixedArea-e.getBoundingClientRect().left+5);var t=e.closest(".spread-sheet__body").getBoundingClientRect();if(e.getBoundingClientRect().right>t.right){var o=e.getBoundingClientRect().right-t.right;this.$refs.SheetBody.$el.scrollLeft+=o+17,this.$refs.SheetBodyFixed.scrollLeft+=o+17}e.focus(),this.selectedCell(e.getAttribute("data-name"))},getCellNodeForName:function(e){return this.$refs.TableBody.querySelector('[data-name="'.concat(e,'"]'))},getExpectedCellName:function(e,t){var o=e.getAttribute("data-name"),n=Object(a["c"])(o),i=n.parthDigit,l=n.parthSymbol;if("next"===t&&(l=this.columns[this.columns.findIndex((function(e){return e.name===l}))+1].name),"previous"===t&&(l=this.columns[this.columns.findIndex((function(e){return e.name===l}))-1].name),"up"===t){i-=1;while(i>1){if(this.rows.find((function(e){return e.value===i}))||this.rowsFixed.find((function(e){return e.value===i})))break;i-=1}}if("down"===t){i+=1;while(i<this.rows[this.rows.length-1].value){var s;if(this.rows.find((function(e){return e.value===i}))||this.rowsFixed.find((function(e){return e.value===i})))if(null===(s=this.setExcludedCells[o])||void 0===s||!s.includes("".concat(l).concat(i)))break;i+=1}}return"".concat(l).concat(i)},getMergedCellName:function(e,t){var o=this,n=Object.entries(this.setExcludedCells).find((function(n){return n[1].includes(o.getExpectedCellName(e,t))}))[0];return n},hasElement:function(e,t){if("previous"===t){if(!e.previousSibling)return!1;if("DIV"===e.previousSibling.nodeName&&e.previousSibling.closest(".column-title"))return!1}if("next"===t){if(!e.nextSibling)return!1;if(!e.nextElementSibling)return!1}var o,n;if("up"===t&&(!e.parentElement.parentElement.previousSibling&&(null===(o=e.closest(".sheet-body"))||void 0===o||!o.previousSibling)))return!1;if("down"===t&&(!e.parentElement.parentElement.nextSibling&&(null===(n=e.closest(".sheet-body-fixed"))||void 0===n||!n.nextSibling)))return!1;return!0},isCopyKey:function(e){var t=e.target.getAttribute("data-name");return!!t&&(!(!e.ctrlKey||"KeyC"!==e.code)&&(this.$emit("buffer:copy",t),!0))},isNavigationKey:function(e){return e.preventDefault(),("ArrowRight"===e.code||"Tab"===e.code&&!e.shiftKey)&&this.moveCursorNext(e.target),("ArrowLeft"===e.code||"Tab"===e.code&&e.shiftKey)&&this.moveCursorPrevious(e.target),"ArrowUp"===e.code&&this.moveCursorUp(e.target),"ArrowDown"===e.code&&this.moveCursorDown(e.target),e.code.includes("Arrow")},isPasteKey:function(e){var t=e.target.getAttribute("data-name");return!!t&&(!(!e.ctrlKey||"KeyV"!==e.code)&&(this.$emit("buffer:paste",t),!0))},moveCursorDown:function(e){if(!this.hasElement(e,"down"))return!1;var t=this.getExpectedCellName(e,"down"),o=this.getCellNodeForName(t);if(o)return this.shiftBodyScrollDown(o),this.focusCell(o),!0;var n=this.getMergedCellName(e,"down"),i=this.getCellNodeForName(n);return!!i&&(this.shiftBodyScrollDown(i),this.focusCell(i),!0)},moveCursorNext:function(e){if(!this.hasElement(e,"next"))return!1;if("DIV"===e.nextSibling.nodeName)return this.focusCell(e.nextSibling),!0;var t=e.getAttribute("data-name");return this.setExcludedCells[t]?(this.focusCell(e.nextElementSibling),!0):(this.focusCell(this.getCellNodeForName(this.getMergedCellName(e,"next"))),!0)},moveCursorPrevious:function(e){return!!this.hasElement(e,"previous")&&("DIV"===e.previousSibling.nodeName&&e.previousSibling.closest(".column-body")?(this.focusCell(e.previousSibling),!0):(this.focusCell(this.getCellNodeForName(this.getMergedCellName(e,"previous"))),!0))},moveCursorUp:function(e){if(!this.hasElement(e,"up"))return!1;var t=this.getExpectedCellName(e,"up"),o=this.getCellNodeForName(t);if(o)return this.shiftBodyScrollUp(o),this.focusCell(o),!0;var n=this.getMergedCellName(e,"up"),i=this.getCellNodeForName(n);return!!i&&(this.shiftBodyScrollUp(i),this.focusCell(i),!0)},selectedCell:function(e){var t=this.getCellNodeForName(e);e!==this.currentSelectedCellName?(this.currentSelectedCellName&&this.getCellNodeForName(this.currentSelectedCellName)&&this.getCellNodeForName(this.currentSelectedCellName).classList.remove("selected"),t&&(t.classList.add("selected"),this.currentSelectedCellName=e)):t.classList.add("selected")},shiftBodyScrollDown:function(e){var t=this.$refs.TableBody.getBoundingClientRect(),o=e.getBoundingClientRect();if(o.bottom>t.bottom){var n=o.bottom-t.bottom;this.$refs.SheetBody.$el.scrollTop+=n+18}},shiftBodyScrollUp:function(e){var t=this.$refs.TableBody.getBoundingClientRect(),o=e.getBoundingClientRect();if(o.top<t.top+10){var n=t.top+10-o.top;this.$refs.SheetBody.$el.scrollTop-=n+12}}}},ce=ue,pe=Object(h["a"])(ce,U,q,!1,null,null,null),de=pe.exports,he={name:"SpreadSheet",components:{TableLayout:f,SpreadSheetAngle:I,SpreadSheetHead:z,SpreadSheetBody:de},props:{cells:{type:Object,default:function(){return{}}},cellHeight:{type:Number,default:x},cellWidth:{type:Number,default:S},columnCount:{type:Number,default:50},columns:{type:Object,default:function(){return{}}},rowCount:{type:Number,default:1e3},rows:{type:Object,default:function(){return{}}},representations:{type:Map,default:function(){return new Map}},styles:{type:Array,default:function(){return[]}},images:{type:Object,default:function(){return{}}},isShowGrid:{type:Boolean,default:!0},isShowTitle:{type:Boolean,default:!0}},data:function(){return{setOpenGroupColumns:[],setOpenGroupRows:[],setExcludedCells:{}}},computed:{maxColumnGroupingLevel:function(){var e=[0];this.prepareColumns.filter((function(e){return Object.keys(e).includes("level")})).forEach((function(t){e.push(t.level)}));var t=0===Math.max.apply(Math,e)?Math.max.apply(Math,e):Math.max.apply(Math,e)+1;return t},maxRowGroupingLevel:function(){var e=[0];this.prepareRows.filter((function(e){return Object.keys(e).includes("level")})).forEach((function(t){e.push(t.level)}));var t=0===Math.max.apply(Math,e)?Math.max.apply(Math,e):Math.max.apply(Math,e)+1;return t},prepareCells:function(){var e=this,t={};return Object.entries(this.cells).forEach((function(o){var n=Object(r["a"])(o,2),i=n[0],l=n[1],u=Object(a["c"])(i),c=u.parthSymbol,p=u.parthDigit,d=Object.keys(l);t[i]=Object(s["a"])({},l);var h=0;if(d.includes("colspan")){h=l.colspan,e.setExcludedCells[i]=[];for(var m=1;m<h;m+=1){var f=Object(a["a"])(Object(a["b"])(c)+m);e.setExcludedCells[i].push("".concat(f).concat(p))}t[i]["grid-column-start"]=e.isPrintMode?1:e.maxRowGroupingLevel+2,t[i]["grid-column-end"]=(e.isPrintMode?1:e.maxRowGroupingLevel+2)+h}else t[i]["grid-column-start"]=e.isPrintMode?1:e.maxRowGroupingLevel+2,t[i]["grid-column-end"]=(e.isPrintMode?1:e.maxRowGroupingLevel+2)+1;var g=e.rows["".concat(p)]&&e.rows["".concat(p)].height||e.cellHeight;if(d.includes("rowspan")){Object.keys(e.setExcludedCells).includes(i)||(e.setExcludedCells[i]=[]);for(var v=1;v<l.rowspan;v+=1){if(e.setExcludedCells[i].push("".concat(c).concat(p+v)),d.includes("colspan")){h=l.colspan;for(var b=1;b<h;b+=1){var y=Object(a["a"])(Object(a["b"])(c)+b);e.setExcludedCells[i].push("".concat(y).concat(p+v))}}g+=e.rows["".concat(p+v)]&&e.rows["".concat(p+v)].height||e.cellHeight}}t[i].height=g})),t},prepareColumns:function(){for(var e=[],t=Object.keys(this.columns),o=1;o<this.columnCount+1;o+=1){var n=Object(a["a"])(o),i={value:o,name:n,width:this.cellWidth,level:0};t.includes(n)&&Object.assign(i,Object(s["a"])({},this.columns[n])),e.push(i)}return e},prepareRows:function(){for(var e=[],t=Object.keys(this.rows),o=1;o<this.rowCount+1;o+=1){var n={value:o,height:this.cellHeight,level:0};t.includes("".concat(o))&&Object.assign(n,Object(s["a"])({},this.rows[o])),e.push(n)}return console.log("prepare row"),e},tableCells:function(){return this.prepareCells},tableColumns:function(){var e=this,t=[],o=0;return this.prepareColumns.forEach((function(n){var i=n.level;(i===o||i<o)&&t.push(n),i<o&&(o=i),e.setOpenGroupColumns.includes(n.name)&&o===i&&(o=i+1)})),t},tableRows:function(){var e=this,t=[],o=0;return this.prepareRows.forEach((function(n){var i=n.level,l=n.fixed;(i===o&&!l||i<o)&&t.push(n),i<o&&(o=i),e.setOpenGroupRows.includes(n.value)&&o===i&&(o=i+1)})),console.log("table row"),t},templateColumnWidth:function(){for(var e="",t=0;t<this.tableColumns.length;t+=1)e+="".concat(this.tableColumns[t].width,"px ");return e},tableWidth:function(){var e=0;return this.tableColumns.forEach((function(t){e+=t.width})),e},spreadSheetStyle:function(){var e=y*this.maxRowGroupingLevel,t=C*this.maxColumnGroupingLevel;this.isShowTitle&&(e+=b,t+=w),0!==this.maxRowGroupingLevel&&(e+=this.isShowTitle?4:5),0!==this.maxColumnGroupingLevel&&(t+=(this.isShowTitle,5));var o={"grid-template-rows":"".concat(t,"px 1fr"),"grid-template-columns":"".concat(e,"px 1fr")};return o}},watch:{cells:function(){this.setExcludedCells={}},rows:function(){var e=this,t=Object.entries(this.rows).filter((function(e){var t=Object(r["a"])(e,2),o=t[1];return Object.keys(o).includes("isOpen")}));t.forEach((function(t){var o=Object(r["a"])(t,1),n=o[0];e.setOpenGroupRows.push(+n)}))},columns:function(){var e=this,t=Object.entries(this.columns).filter((function(e){var t=Object(r["a"])(e,2),o=t[1];return Object.keys(o).includes("isOpen")}));t.forEach((function(t){var o=Object(r["a"])(t,1),n=o[0];e.setOpenGroupColumns.push(n)}))},styles:function(){this.updateDocumentStyles()}},mounted:function(){this.updateDocumentStyles()},beforeDestroy:function(){this.updateDocumentStyles(!1)},methods:{evtClickCell:function(e){this.$emit("click:cell",e)},evtDblclickCell:function(e){this.$emit("dblclick:cell",e)},evtKeydownCell:function(e){this.$emit("keydown:cell",e)},evtBufferCopy:function(e){this.$emit("buffer:copy",e)},evtBufferPaste:function(e){this.$emit("buffer:paste",e)},evtOpenGroupColumn:function(e){var t=[],o=[];this.prepareColumns.forEach((function(n){Object.keys(n).includes("isGroup")&&(n.level<e-1&&t.push(n.name),n.level===e-1&&o.push(n.name))})),this.setOpenGroupColumns=this.setOpenGroupColumns.filter((function(e){return!o.includes(e)})),this.setOpenGroupColumns=Object(l["a"])(new Set([].concat(Object(l["a"])(this.setOpenGroupColumns),t)))},evtOpenGroupRow:function(e){var t=[],o=[];this.prepareRows.forEach((function(n){Object.keys(n).includes("isGroup")&&(n.level<e-1&&t.push(n.value),n.level===e-1&&o.push(n.value))})),this.setOpenGroupRows=this.setOpenGroupRows.filter((function(e){return!o.includes(e)})),this.setOpenGroupRows=Object(l["a"])(new Set([].concat(Object(l["a"])(this.setOpenGroupRows),t)))},toggleColumnGroup:function(e){this.setOpenGroupColumns.includes(e)?this.setOpenGroupColumns.splice(this.setOpenGroupColumns.findIndex((function(t){return t===e})),1):this.setOpenGroupColumns.push(e)},toggleRowGroup:function(e){this.setOpenGroupRows.includes(e)?this.setOpenGroupRows.splice(this.setOpenGroupRows.findIndex((function(t){return t===e})),1):this.setOpenGroupRows.push(e),console.log(this.setOpenGroupRows)},scrollBodyX:function(e){this.$refs.SheetHead.$el.scrollLeft=e,this.$emit("scroll:body")},updateDocumentStyles:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=document.querySelector('head [data-style="style-cell"]');t&&t.remove(),e&&this.addingDocumentStyles()},addingDocumentStyles:function(){var e=this,t="",o=[];t=" .spread-sheet .spread-sheet__body .body-virtual .sheet-body__row ",this.isPrintMode&&(t=".spread-sheet-print .sheet .sheet-body-print .sheet-body__row ");var n=document.createElement("style"),i="";n.setAttribute("type","text/css"),n.setAttribute("data-style","style-cell"),this.styles.forEach((function(t){var n=Object.keys(t.list);(n.includes("borderBottom")||n.includes("borderRight"))&&o.push(e.getPseudoBorder(t)),o.push(e.getStyleCell(t))})),o.forEach((function(o){var n={};Object.entries(o.list).forEach((function(t){var o=Object(l["a"])(t),i=o[0],s=o[1];n[e.transformStringToKebabCase(i)]=s})),i+="".concat(t," .").concat(o.name," ").concat(e.transformObjectToStringStyle(n))})),n.innerText="".concat(i," ").concat(this.isPrintMode?".no-print {display: none !important}}":""),document.querySelector("head").append(n)},getPseudoBorder:function(e){var t={name:"".concat(e.name,"::after"),list:{content:"''",position:"absolute",left:"0px",top:"-1.4px",right:"-1px",bottom:"-0.6px","z-index":"80"}},o=Object.keys(e.list);return o.includes("borderRight")&&(t.list.borderRight=e.list.borderRight,t.list.right="-".concat(.8*+e.list.borderRight[0],"px")),o.includes("borderBottom")&&(t.list.borderBottom=e.list.borderBottom),o.includes("borderLeft")&&(t.list.left="-".concat(1*+e.list.borderLeft[0],"px")),t},getStyleCell:function(e){var t={name:e.name,list:{}};return Object.entries(e.list).forEach((function(e){var o=Object(r["a"])(e,2),n=o[0],i=o[1];t.list[n]=i})),Object.keys(t.list).includes("borderRight")&&delete t.list.borderRight,Object.keys(t.list).includes("borderBottom")&&delete t.list.borderBottom,t},transformStringToKebabCase:function(e){return e.replace(/[A-Z]/g,(function(e){return"-".concat(e.toLowerCase())}))},transformObjectToStringStyle:function(e){return JSON.stringify(e).replace(/","/g,";").replace(/"/g,"").replace(/}/g,";}")},newDocument:function(){this.setOpenGroupColumns=[],this.setOpenGroupRows=[],this.setExcludedCells={}}}},me=he,fe=(o("72a8"),Object(h["a"])(me,n,i,!1,null,"1cbcd236",null));t["a"]=fe.exports},"88c4":function(e,t,o){"use strict";o("6687")},9662:function(e,t,o){},9889:function(e,t,o){},a202:function(e,t,o){"use strict";o("17ea")},be08:function(e,t,o){"use strict";o("008d")},dd65:function(e,t,o){"use strict";o("9889")},ffc3:function(e,t,o){"use strict";o("5317")}}]);
//# sourceMappingURL=chunk-afa86b7c.63a6457e.js.map