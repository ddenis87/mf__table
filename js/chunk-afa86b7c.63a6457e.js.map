{"version":3,"sources":["webpack:///./src/helpers/spreadSheet.js","webpack:///./src/components/SpreadSheet/SpreadSheet.vue?493c","webpack:///./src/components/SpreadSheet/SpreadSheet.vue?9ee9","webpack:///./src/components/TableLayout.vue?0509","webpack:///src/components/TableLayout.vue","webpack:///./src/components/TableLayout.vue?dac0","webpack:///./src/components/TableLayout.vue","webpack:///./src/components/SpreadSheet/component/SpreadSheetAngle.vue?e3fd","webpack:///./src/components/SpreadSheet/SpreadSheetConst.js","webpack:///./src/components/SpreadSheet/component/SpreadSheetBtnGroup.vue?74a7","webpack:///src/components/SpreadSheet/component/SpreadSheetBtnGroup.vue","webpack:///./src/components/SpreadSheet/component/SpreadSheetBtnGroup.vue?be1e","webpack:///./src/components/SpreadSheet/component/SpreadSheetBtnGroup.vue","webpack:///src/components/SpreadSheet/component/SpreadSheetAngle.vue","webpack:///./src/components/SpreadSheet/component/SpreadSheetAngle.vue?014f","webpack:///./src/components/SpreadSheet/component/SpreadSheetAngle.vue","webpack:///./src/components/SpreadSheet/component/SpreadSheetHead.vue?217d","webpack:///src/components/SpreadSheet/component/SpreadSheetHead.vue","webpack:///./src/components/SpreadSheet/component/SpreadSheetHead.vue?9400","webpack:///./src/components/SpreadSheet/component/SpreadSheetHead.vue","webpack:///./src/components/SpreadSheet/component/SpreadSheetBody.vue?e0f2","webpack:///./src/components/Form/Tooltip/Tooltip.vue?7bb7","webpack:///src/components/Form/Tooltip/Tooltip.vue","webpack:///./src/components/Form/Tooltip/Tooltip.vue?e958","webpack:///./src/components/Form/Tooltip/Tooltip.vue","webpack:///./src/components/SpreadSheet/component/SpreadSheetBodyItem.vue?16ea","webpack:///src/components/SpreadSheet/component/SpreadSheetBodyItem.vue","webpack:///./src/components/SpreadSheet/component/SpreadSheetBodyItem.vue?44bb","webpack:///./src/components/SpreadSheet/component/SpreadSheetBodyItem.vue","webpack:///src/components/SpreadSheet/component/SpreadSheetBody.vue","webpack:///./src/components/SpreadSheet/component/SpreadSheetBody.vue?7c84","webpack:///./src/components/SpreadSheet/component/SpreadSheetBody.vue","webpack:///src/components/SpreadSheet/SpreadSheet.vue","webpack:///./src/components/SpreadSheet/SpreadSheet.vue?3985","webpack:///./src/components/SpreadSheet/SpreadSheet.vue","webpack:///./src/components/TableLayout.vue?75d2","webpack:///./src/components/SpreadSheet/component/SpreadSheetHead.vue?2124","webpack:///./src/components/SpreadSheet/component/SpreadSheetBodyItem.vue?8c48","webpack:///./src/components/SpreadSheet/component/SpreadSheetBtnGroup.vue?e79f","webpack:///./src/components/SpreadSheet/component/SpreadSheetAngle.vue?8375"],"names":["SET_COLUMN_NAME","REG_SYMBOLS","REG_DIGITS","getColumnNameForNumber","number","settLength","length","columnName","Math","floor","getColumnNumberForName","name","nameLowerCase","toLowerCase","findIndex","item","indexFirst","indexSecond","getParseAtSymbolDigit","str","parthSymbol","replace","parthDigit","render","_vm","this","_h","$createElement","_c","_self","attrs","staticClass","style","maxColumnGroupingLevel","maxRowGroupingLevel","isShowTitle","on","evtOpenGroupColumn","evtOpenGroupRow","ref","tableColumns","templateColumnWidth","tableWidth","setOpenGroupColumns","toggleColumnGroup","tableRows","tableCells","representations","images","setExcludedCells","setOpenGroupRows","isShowGrid","evtClickCell","evtDblclickCell","evtKeydownCell","evtBufferCopy","evtBufferPaste","toggleRowGroup","scrollBodyX","staticRenderFns","_t","props","padding","computed","tableLayoutStyle","component","class","_l","levelColumn","key","evtClickGroupColumn","_v","_s","_e","levelRow","evtClickGroupRow","CELL_WIDTH_TITLE","CELL_WIDTH_GROUP","CELL_HEIGHT_TITLE","CELL_HEIGHT_GROUP","CELL_HEIGHT_BODY","CELL_WIDTH_BODY","CELL_WIDTH_LEFT_TITLE","CELL_HEIGHT","CELL_WIDTH_LEFT_GROUP","isDisabled","event","$emit","VBtn","components","SpreadSheetBtnGroup","angleStyle","columnGroupStyle","rowGroupStyle","rbStyle","methods","level","eventClickHead","templateRowGroup","column","columnIndex","getGroupClass","getGroupStyle","isGroup","includes","getCellStyle","toUpperCase","_m","columns","templateRow","width","rowHeight","evt","target","closest","console","log","fixed","cellStyle","position","left","i","columnLevel","groupClass","push","isGroupEnd","groupStyle","VIcon","evtClickBody","evtDblClickBody","evtKeydownBody","evtMousedown","_b","propsTooltip","styleWrapRow","rows","sheetBodyItem","propsItemBody","evtScrollList","evtResizedList","evtClose","model","value","callback","$$v","isShow","expression","positionTooltip","text","top","VTooltip","rowName","levelIndex","btnGroup","checkCellExclusion","source","getCellClass","getCellName","getTooltip","hasImg","domProps","getImg","hasTooltip","formattedData","cells","Array","index","isShowGroup","setRepresentations","data","gridRow","templateColumnTitle","shiftTitle","shiftLeft","tempalteColumnTitle","cellName","cell","Object","keys","hasCell","cellClass","getCellFixed","cellFixed","getCellGeometry","cellGeometry","columnStart","columnEnd","height","rowLevel","Tooltip","rowsFixed","SpreadSheetBodyItem","isTooltipTimer","propsItem","styleBody","heightVirtualList","heightBodyFixed","widthVirtualList","title","maxLevelGroupRow","mounted","sheetBodyGeometry","$refs","SheetBody","$el","getBoundingClientRect","hasAttribute","isNavigationKey","setTemplateKey","find","isCopyKey","isPasteKey","ctrlKey","preventDefault","selectEnd","selectStart","isTrySelected","focusCell","getCellNodeForName","evtMouseout","clearTimeout","evtMouseover","setTimeout","titleText","targetPosition","right","currentSelectedCellName","cellSelectedNode","cellSelectedGeometry","scrollLeft","widthFixedArea","SheetBodyFixed","geometryVirtualScroll","delta","focus","selectedCell","getAttribute","TableBody","querySelector","getExpectedCellName","direction","cellColumn","cellRow","getMergedCellName","mergedCellName","hasElement","previousSibling","nodeName","nextSibling","nextElementSibling","parentElement","code","moveCursorUp","moveCursorDown","expectedCell","shiftBodyScrollDown","mergedCell","moveCursorNext","currentCellName","moveCursorPrevious","shiftBodyScrollUp","classList","remove","cellNode","add","cellBorders","bottom","bodyBorders","scrollTop","TableLayout","SpreadSheetAngle","SpreadSheetHead","SpreadSheetBody","cellHeight","cellWidth","columnCount","rowCount","styles","prepareColumns","filter","maxLevelGroup","result","prepareRows","row","prepareCells","entries","forEach","cellValueKeys","colspan","cellValue","columnsKeys","assign","columnItem","rowsKeys","rowItem","showLevel","spreadSheetStyle","titleColumn","titleRow","watch","rowValue","rowsOpen","columnValue","columnOpen","updateDocumentStyles","beforeDestroy","options","openGroup","closeGroup","splice","SheetHead","create","addingDocumentStyles","stylesPath","isPrintMode","elementDOMStyle","setAttribute","listKeys","prepareStyles","element","list","stylesObject","stylesString","innerText","document","append","getPseudoBorder","content","pseudoBorder","borderRight","borderBottom","getStyleCell","styleCell","transformStringToKebabCase","styleName","transformObjectToStringStyle","JSON","stringify","object","newDocument"],"mappings":"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","file":"js/chunk-afa86b7c.63a6457e.js","sourcesContent":["const SET_COLUMN_NAME = ['a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j', 'k', 'l', 'm', 'n', 'o', 'p', 'q', 'r', 's', 't', 'u', 'v', 'w', 'x', 'y', 'z'];\r\n\r\nconst REG_SYMBOLS = /[A-Z]/gi;\r\nconst REG_DIGITS = /[0-9]/g;\r\n\r\nfunction getColumnNameForNumber(number) {\r\n  if (number > 702) return 'Infinity';\r\n  const settLength = SET_COLUMN_NAME.length;\r\n  if (number <= settLength) {\r\n    const columnName = SET_COLUMN_NAME[number - 1];\r\n    return columnName;\r\n  }\r\n  if ((number % settLength) === 0) {\r\n    const columnName = `${SET_COLUMN_NAME[\r\n      ((number - settLength) / settLength) - 1\r\n    ]}${SET_COLUMN_NAME[settLength - 1]}`;\r\n    return columnName;\r\n  }\r\n  const columnName = `${SET_COLUMN_NAME[\r\n    (Math.floor(number / settLength)) - 1\r\n  ]}${SET_COLUMN_NAME[(number % settLength) - 1]}`;\r\n  return columnName;\r\n}\r\n\r\nfunction getColumnNumberForName(name) {\r\n  const nameLowerCase = name.toLowerCase();\r\n  if (nameLowerCase.length === 1) return SET_COLUMN_NAME.findIndex((item) => item === nameLowerCase) + 1;\r\n  const indexFirst = SET_COLUMN_NAME.findIndex((item) => item === nameLowerCase[0]) + 1;\r\n  const indexSecond = SET_COLUMN_NAME.findIndex((item) => item === nameLowerCase[1]) + 1;\r\n  return (indexFirst * SET_COLUMN_NAME.length) + indexSecond;\r\n}\r\n\r\nfunction getParseAtSymbolDigit(str) {\r\n  return {\r\n    parthSymbol: str.replace(REG_DIGITS, ''),\r\n    parthDigit: +str.replace(REG_SYMBOLS, ''),\r\n  };\r\n}\r\n\r\nexport {\r\n  REG_SYMBOLS,\r\n  REG_DIGITS,\r\n  getColumnNameForNumber,\r\n  getColumnNumberForName,\r\n  getParseAtSymbolDigit,\r\n};\r\n","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SpreadSheet.vue?vue&type=style&index=0&id=1cbcd236&lang=scss&scoped=true&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('table-layout',{attrs:{\"padding\":\"4px 4px 4px 4px\"}},[_c('div',{staticClass:\"spread-sheet\",style:(_vm.spreadSheetStyle)},[_c('spread-sheet-angle',{attrs:{\"max-column-grouping-level\":_vm.maxColumnGroupingLevel,\"max-row-grouping-level\":_vm.maxRowGroupingLevel,\"is-show-title\":_vm.isShowTitle},on:{\"open-group:column\":_vm.evtOpenGroupColumn,\"open-group:row\":_vm.evtOpenGroupRow}}),_c('spread-sheet-head',{ref:\"SheetHead\",attrs:{\"columns\":_vm.tableColumns,\"template-column-width\":_vm.templateColumnWidth,\"table-width\":_vm.tableWidth,\"max-column-grouping-level\":_vm.maxColumnGroupingLevel,\"set-open-group-columns\":_vm.setOpenGroupColumns,\"is-show-title\":_vm.isShowTitle},on:{\"toggle-group:column\":_vm.toggleColumnGroup}}),_c('spread-sheet-body',{ref:\"SpreadSheetBody\",attrs:{\"rows\":_vm.tableRows,\"columns\":_vm.tableColumns,\"cells\":_vm.tableCells,\"representations\":_vm.representations,\"images\":_vm.images,\"template-column-width\":_vm.templateColumnWidth,\"max-row-grouping-level\":_vm.maxRowGroupingLevel,\"max-column-grouping-level\":_vm.maxColumnGroupingLevel,\"set-excluded-cells\":_vm.setExcludedCells,\"table-width\":_vm.tableWidth,\"set-open-group-rows\":_vm.setOpenGroupRows,\"is-show-grid\":_vm.isShowGrid,\"is-show-title\":_vm.isShowTitle},on:{\"click:cell\":_vm.evtClickCell,\"dblclick:cell\":_vm.evtDblclickCell,\"keydown:cell\":_vm.evtKeydownCell,\"buffer:copy\":_vm.evtBufferCopy,\"buffer:paste\":_vm.evtBufferPaste,\"open-group:row\":_vm.toggleRowGroup,\"scroll-body-x\":_vm.scrollBodyX}})],1)])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"table-layout\",style:(_vm.tableLayoutStyle)},[_vm._t(\"default\")],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"table-layout\"\r\n       :style=\"tableLayoutStyle\">\r\n    <slot></slot>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  name: 'TableLayout',\r\n  props: {\r\n    padding: { type: String, default: '0px 0px 0px 0px' },\r\n  },\r\n  computed: {\r\n    tableLayoutStyle() {\r\n      return {\r\n        padding: this.padding,\r\n      };\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.table-layout {\r\n  width: 100%;\r\n  height: 100%;\r\n  border-radius: 4px;;\r\n  box-shadow: 0 -1px 1px -1px rgba(0,0,0,.3),\r\n              0 2px 1px -1px rgba(0,0,0,.3),\r\n              0 1px 1px 0 rgba(0,0,0,.24),\r\n              0 1px 3px 0 rgba(0,0,0,.22);\r\n  overflow: hidden;\r\n  font-family: Arial, Helvetica, sans-serif;\r\n  font-size: 16px;\r\n}\r\n</style>\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TableLayout.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TableLayout.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./TableLayout.vue?vue&type=template&id=7b82dcc5&scoped=true&\"\nimport script from \"./TableLayout.vue?vue&type=script&lang=js&\"\nexport * from \"./TableLayout.vue?vue&type=script&lang=js&\"\nimport style0 from \"./TableLayout.vue?vue&type=style&index=0&id=7b82dcc5&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"7b82dcc5\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"spread-sheet__angle\",class:(_vm.isShowTitle) ? 'angle' : 'angle_no-group',style:(_vm.angleStyle)},[(_vm.isShowTitle && _vm.maxColumnGroupingLevel)?_c('div',{staticClass:\"angle__columnGroup\",style:(_vm.columnGroupStyle)},_vm._l((_vm.maxColumnGroupingLevel),function(levelColumn){return _c('div',{key:levelColumn,staticClass:\"item item_column\",attrs:{\"data-level\":levelColumn}},[_c('spread-sheet-btn-group',{on:{\"click\":_vm.evtClickGroupColumn}},[_c('span',{staticClass:\"btn_text\"},[_vm._v(_vm._s(levelColumn))])])],1)}),0):_vm._e(),(_vm.isShowTitle && _vm.maxRowGroupingLevel)?_c('div',{staticClass:\"angle__rowGroup\",style:(_vm.rowGroupStyle)},_vm._l((_vm.maxRowGroupingLevel),function(levelRow){return _c('div',{key:levelRow,staticClass:\"item\",attrs:{\"data-level\":levelRow}},[_c('spread-sheet-btn-group',{on:{\"click\":_vm.evtClickGroupRow}},[_c('span',{staticClass:\"btn_text\"},[_vm._v(_vm._s(levelRow))])])],1)}),0):_vm._e()])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","const CELL_WIDTH_TITLE = 60;\r\nconst CELL_WIDTH_GROUP = 20;\r\nconst CELL_HEIGHT_TITLE = 22;\r\nconst CELL_HEIGHT_GROUP = 20;\r\nconst CELL_HEIGHT_BODY = 22;\r\nconst CELL_WIDTH_BODY = 94;\r\n\r\nconst CELL_WIDTH_LEFT_TITLE = 60;\r\n\r\nconst CELL_HEIGHT = 22;\r\n\r\nconst CELL_WIDTH = 94;\r\n\r\nconst CELL_WIDTH_LEFT_GROUP = 20;\r\nconst CELL_TYPE_DEFAULT = 'string';\r\n\r\nexport {\r\n  CELL_WIDTH_TITLE,\r\n  CELL_WIDTH_GROUP,\r\n  CELL_HEIGHT_TITLE,\r\n  CELL_HEIGHT_GROUP,\r\n  CELL_HEIGHT_BODY,\r\n  CELL_WIDTH_BODY,\r\n\r\n  CELL_HEIGHT,\r\n  CELL_WIDTH,\r\n  CELL_WIDTH_LEFT_TITLE,\r\n  CELL_WIDTH_LEFT_GROUP,\r\n  CELL_TYPE_DEFAULT,\r\n};\r\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"spread-sheet-btn-group\"},[_c('v-btn',{staticClass:\"action-btn\",attrs:{\"icon\":\"\",\"width\":\"16\",\"height\":\"16\",\"disabled\":_vm.isDisabled},on:{\"click\":function (event) { return _vm.$emit('click', event); }}},[_vm._t(\"default\")],2)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"spread-sheet-btn-group\">\r\n    <v-btn class=\"action-btn\"\r\n         icon\r\n         width=\"16\"\r\n         height=\"16\"\r\n         :disabled=\"isDisabled\"\r\n         @click=\"(event) => $emit('click', event)\">\r\n    <slot></slot>\r\n  </v-btn>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  name: 'SpreadSheetBtnGroup',\r\n  props: {\r\n    // iconColor: { type: String, default: 'black' },\r\n    isDisabled: { type: Boolean, default: false },\r\n  },\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.spread-sheet-btn-group {\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  width: 16px;\r\n  height: 16px;\r\n  border: thin solid grey;\r\n  overflow: hidden;\r\n  .action-btn {\r\n    font-size: 1em;\r\n  }\r\n}\r\n</style>\r\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SpreadSheetBtnGroup.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SpreadSheetBtnGroup.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./SpreadSheetBtnGroup.vue?vue&type=template&id=8eb8881a&scoped=true&\"\nimport script from \"./SpreadSheetBtnGroup.vue?vue&type=script&lang=js&\"\nexport * from \"./SpreadSheetBtnGroup.vue?vue&type=script&lang=js&\"\nimport style0 from \"./SpreadSheetBtnGroup.vue?vue&type=style&index=0&id=8eb8881a&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"8eb8881a\",\n  null\n  \n)\n\nexport default component.exports\n\n/* vuetify-loader */\nimport installComponents from \"!../../../../node_modules/vuetify-loader/lib/runtime/installComponents.js\"\nimport { VBtn } from 'vuetify/lib/components/VBtn';\ninstallComponents(component, {VBtn})\n","<template>\r\n  <div class=\"spread-sheet__angle\"\r\n       :class=\"(isShowTitle) ? 'angle' : 'angle_no-group'\"\r\n       :style=\"angleStyle\">\r\n    <div v-if=\"isShowTitle && maxColumnGroupingLevel\" class=\"angle__columnGroup\"\r\n         :style=\"columnGroupStyle\">\r\n      <div v-for=\"levelColumn in maxColumnGroupingLevel\"\r\n           class=\"item item_column\"\r\n           :key=\"levelColumn\"\r\n           :data-level=\"levelColumn\">\r\n        <spread-sheet-btn-group @click=\"evtClickGroupColumn\">\r\n          <span class=\"btn_text\">{{ levelColumn }}</span>\r\n        </spread-sheet-btn-group>\r\n      </div>\r\n    </div>\r\n    <div v-if=\"isShowTitle && maxRowGroupingLevel\" class=\"angle__rowGroup\"\r\n         :style=\"rowGroupStyle\">\r\n      <div v-for=\"levelRow in maxRowGroupingLevel\"\r\n           class=\"item\"\r\n           :key=\"levelRow\"\r\n           :data-level=\"levelRow\">\r\n        <spread-sheet-btn-group @click=\"evtClickGroupRow\">\r\n          <span class=\"btn_text\">{{ levelRow }}</span>\r\n        </spread-sheet-btn-group>\r\n      </div>\r\n    </div>\r\n    <!-- <div v-if=\"maxRowGroupingLevel || maxColumnGroupingLevel\"\r\n         class=\"angle__rb\"\r\n         :class=\"{'angle__rb_left': maxRowGroupingLevel\r\n          && maxColumnGroupingLevel, 'angle__rb_top': maxColumnGroupingLevel && isShowTitle}\"\r\n         :style=\"rbStyle\"></div> -->\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport {\r\n  CELL_WIDTH_GROUP,\r\n  CELL_HEIGHT_GROUP,\r\n  CELL_HEIGHT_TITLE,\r\n  CELL_WIDTH_TITLE,\r\n} from '../SpreadSheetConst';\r\nimport SpreadSheetBtnGroup from './SpreadSheetBtnGroup.vue';\r\n\r\nexport default {\r\n  name: 'SpreadSheetAngle',\r\n  components: {\r\n    SpreadSheetBtnGroup,\r\n  },\r\n  props: {\r\n    maxRowGroupingLevel: { type: Number, default: 0 },\r\n    maxColumnGroupingLevel: { type: Number, default: 0 },\r\n    isShowTitle: { type: Boolean, default: true },\r\n  },\r\n  computed: {\r\n    angleStyle() {\r\n      // let angleStyle = {\r\n      //   'grid-template-rows': `${(this.maxColumnGroupingLevel * CELL_HEIGHT_GROUP) + 4}px 1fr`,\r\n      //   'grid-template-columns': `${(this.maxRowGroupingLevel * CELL_WIDTH_GROUP) + 4}px 1fr`,\r\n      // };\r\n      let angleStyle = {\r\n        'grid-template-rows': `1fr ${CELL_HEIGHT_TITLE - 1}px`,\r\n        'grid-template-columns': `1fr ${CELL_WIDTH_TITLE - 2}px`,\r\n      };\r\n      if (this.maxColumnGroupingLevel === 0) {\r\n        angleStyle['grid-template-areas'] = '\"rowGroup rb\"';\r\n        angleStyle['grid-template-rows'] = '1fr';\r\n        angleStyle['grid-template-columns'] = `1fr ${CELL_WIDTH_TITLE - 2}px`;\r\n        // angleStyle['padding-bottom'] = '2px';\r\n      }\r\n      if (!this.isShowTitle) {\r\n        angleStyle = {\r\n          'grid-template-rows': '1fr',\r\n          'grid-template-columns': '1fr',\r\n        };\r\n      }\r\n      return angleStyle;\r\n    },\r\n    columnGroupStyle() {\r\n      const columnGroupStyle = {\r\n        'grid-template-rows': `repeat(${this.maxColumnGroupingLevel}, ${CELL_HEIGHT_GROUP}px)`,\r\n        // 'grid-template-columns': `${CELL_WIDTH_TITLE}px`,\r\n        // 'grid-template-columns': '1fr',\r\n      };\r\n      return columnGroupStyle;\r\n    },\r\n\r\n    rowGroupStyle() {\r\n      const rowGroupStyle = {\r\n        'grid-template-columns': `repeat(${this.maxRowGroupingLevel}, ${CELL_WIDTH_GROUP}px)`,\r\n        'grid-template-rows': `${CELL_HEIGHT_TITLE}px`,\r\n      };\r\n      if (this.maxColumnGroupingLevel === 0) {\r\n        rowGroupStyle['padding-top'] = '2px';\r\n        rowGroupStyle['align-items'] = 'flex-start';\r\n      }\r\n      return rowGroupStyle;\r\n    },\r\n\r\n    rbStyle() {\r\n      const rbStyle = {};\r\n      return rbStyle;\r\n    },\r\n  },\r\n  methods: {\r\n    evtClickGroupColumn(evt) {\r\n      const level = evt.target.closest('.item').getAttribute('data-level');\r\n      this.$emit('open-group:column', +level);\r\n    },\r\n    evtClickGroupRow(evt) {\r\n      const level = evt.target.closest('.item').getAttribute('data-level');\r\n      this.$emit('open-group:row', +level);\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.angle {\r\n  display: grid;\r\n  grid-template-areas: \"lt columnGroup\"\r\n                       \"rowGroup rb\";\r\n  font-size: .7em;\r\n  width: 100%;\r\n  height: 100%;\r\n  box-sizing: border-box;\r\n  &_no-group {\r\n    grid-template-areas: \"lt\";\r\n  }\r\n  &__columnGroup {\r\n    grid-area: columnGroup;\r\n    display: grid;\r\n    grid-template-columns: 1fr;\r\n    justify-items: end;\r\n    align-items: end;\r\n    padding-right: 4px;\r\n    border-bottom: thin solid grey;\r\n    // box-shadow: 0px 3px 0px grey;\r\n  }\r\n  &__rowGroup {\r\n    position: relative;\r\n    grid-area: rowGroup;\r\n    display: grid;\r\n    justify-items: end;\r\n    align-items: start;\r\n  //   padding-top: 3px;\r\n    border-right: thin solid grey;\r\n    // box-shadow: 3px 0px 0px grey;\r\n    &::after {\r\n      content: '';\r\n      position: absolute;\r\n      right: -1px;\r\n      top: -1px;\r\n      left: 0px;\r\n      bottom: -1px;\r\n      // border-top: thin solid grey;\r\n      border-right: thin solid grey;\r\n    }\r\n  }\r\n  &__rb {\r\n  //   // top: 2px;\r\n    position: relative;\r\n    grid-area: rb;\r\n    box-sizing: border-box;\r\n    // border-left: thin solid grey;\r\n    // border-top: thin solid grey;\r\n  //   &_left {\r\n  //     border-left: thin solid grey;\r\n  //     &::after {\r\n  //       // border-left: thin solid grey;\r\n  //     }\r\n    // }\r\n  //   &_top {\r\n  //     border-top: thin solid grey;\r\n  //     &::after {\r\n  //       // border-top: thin solid grey;\r\n  //     }\r\n  //   }\r\n    // &::after {\r\n    //   content: '';\r\n    //   position: absolute;\r\n    //   left: -1px;\r\n    //   top: -1px;\r\n    //   width: 5px;\r\n    //   height: 5px;\r\n    //   border-top: thin solid grey;\r\n    //   border-left: thin solid grey;\r\n    // }\r\n  }\r\n  // .item {\r\n  //   display: flex;\r\n  //   justify-content: flex-end;\r\n  //   &_column {\r\n  //     align-items: flex-end;\r\n  //     padding-right: 4px;\r\n  //   }\r\n  // }\r\n}\r\n</style>\r\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SpreadSheetAngle.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SpreadSheetAngle.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./SpreadSheetAngle.vue?vue&type=template&id=6991d391&scoped=true&\"\nimport script from \"./SpreadSheetAngle.vue?vue&type=script&lang=js&\"\nexport * from \"./SpreadSheetAngle.vue?vue&type=script&lang=js&\"\nimport style0 from \"./SpreadSheetAngle.vue?vue&type=style&index=0&id=6991d391&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"6991d391\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"spread-sheet__head\",class:{'spread-sheet__head_bottom-line': _vm.isShowTitle},on:{\"click\":_vm.eventClickHead}},[_vm._l((_vm.maxColumnGroupingLevel),function(level){return _c('div',{key:level,staticClass:\"rows rows__group\",style:(_vm.templateRowGroup(level))},[_vm._l((_vm.columns),function(column,columnIndex){return _c('div',{key:columnIndex,staticClass:\"column column-group\",class:_vm.getGroupClass(level, column, columnIndex),style:(_vm.getGroupStyle(level))},[(_vm.isGroup(column, level))?_c('spread-sheet-btn-group',{attrs:{\"data-column-name\":column.name}},[_c('v-icon',{attrs:{\"x-small\":\"\",\"color\":\"black\"}},[_vm._v(\" \"+_vm._s((_vm.setOpenGroupColumns.includes(column.name)) ? 'mdi-minus' : 'mdi-plus')+\" \")])],1):_vm._e()],1)}),_c('div',{staticClass:\"column column-group column-end\"})],2)}),(_vm.isShowTitle)?_c('div',{staticClass:\"rows rows__title\",style:(_vm.templateRow)},[_vm._l((_vm.columns),function(column,columnIndex){return [_c('div',{key:(\"head-title-\" + (column.value)),staticClass:\"column column-title\",style:(_vm.getCellStyle(column, columnIndex))},[_c('div',{staticClass:\"content\"},[_vm._v(_vm._s(column.name.toUpperCase()))])])]}),_vm._m(0)],2):_vm._e()],2)}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"column column-title column-end\"},[_c('div',{staticClass:\"content\"})])}]\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"spread-sheet__head\"\r\n       :class=\"{'spread-sheet__head_bottom-line': isShowTitle}\"\r\n       @click=\"eventClickHead\">\r\n    <div v-for=\"level in maxColumnGroupingLevel\"\r\n         class=\"rows rows__group\"\r\n         :key=\"level\"\r\n         :style=\"templateRowGroup(level)\">\r\n      <div v-for=\"(column, columnIndex) in columns\"\r\n            class=\"column column-group\"\r\n            :key=\"columnIndex\"\r\n            :class=\"getGroupClass(level, column, columnIndex)\"\r\n            :style=\"getGroupStyle(level)\">\r\n        <spread-sheet-btn-group v-if=\"isGroup(column, level)\"\r\n                                :data-column-name=\"column.name\">\r\n          <v-icon x-small color=\"black\">\r\n            {{ (setOpenGroupColumns.includes(column.name)) ? 'mdi-minus' : 'mdi-plus' }}\r\n          </v-icon>\r\n        </spread-sheet-btn-group>\r\n      </div>\r\n      <div class=\"column column-group column-end\"></div>\r\n    </div>\r\n\r\n    <div v-if=\"isShowTitle\"\r\n         class=\"rows rows__title\"\r\n         :style=\"templateRow\">\r\n      <template v-for=\"(column, columnIndex) in columns\">\r\n        <div :key=\"`head-title-${column.value}`\"\r\n             class=\"column column-title\"\r\n             :style=\"getCellStyle(column, columnIndex)\">\r\n          <div class=\"content\">{{ column.name.toUpperCase() }}</div>\r\n        </div>\r\n      </template>\r\n      <div class=\"column column-title column-end\">\r\n        <div class=\"content\"></div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport {\r\n  CELL_HEIGHT_GROUP,\r\n  CELL_HEIGHT_TITLE,\r\n} from '../SpreadSheetConst';\r\nimport SpreadSheetBtnGroup from './SpreadSheetBtnGroup.vue';\r\n\r\nexport default {\r\n  name: 'SpreadSheetHead',\r\n  components: {\r\n    SpreadSheetBtnGroup,\r\n  },\r\n  props: {\r\n    columns: { type: Array },\r\n    templateColumnWidth: { type: String, default: '' },\r\n    tableWidth: { type: Number, default: 0 },\r\n    maxColumnGroupingLevel: { type: Number, default: 0 },\r\n    setOpenGroupColumns: { type: Array, default() { return []; } },\r\n    isShowTitle: { type: Boolean, default: true },\r\n  },\r\n  computed: {\r\n    templateRow() {\r\n      const templateRow = {\r\n        'grid-template-columns': `${this.templateColumnWidth} 8px`,\r\n        'grid-template-rows': `${CELL_HEIGHT_TITLE}px`,\r\n        width: `${this.tableWidth}px`,\r\n      };\r\n      // if (this.isShowTitle) templateRow['border-bottom'] = 'thin solid grey';\r\n      return templateRow;\r\n    },\r\n  },\r\n  methods: {\r\n    templateRowGroup(level) {\r\n      let rowHeight = CELL_HEIGHT_GROUP;\r\n      if (level === this.maxColumnGroupingLevel) rowHeight += 5;\r\n      const templateRow = {\r\n        'grid-template-columns': `${this.templateColumnWidth} 8px`,\r\n        'grid-template-rows': `${rowHeight}px`,\r\n        width: `${this.tableWidth}px`,\r\n      };\r\n      return templateRow;\r\n    },\r\n    eventClickHead(evt) {\r\n      if (evt.target.closest('button')) {\r\n        const columnName = evt.target.closest('button').parentElement.getAttribute('data-column-name');\r\n        console.log(columnName);\r\n        this.$emit('toggle-group:column', columnName);\r\n      }\r\n    },\r\n    getCellStyle(column, columnIndex) {\r\n      const cellStyle = {};\r\n      if (column.fixed) {\r\n        cellStyle.position = 'sticky';\r\n        cellStyle['z-index'] = 100;\r\n        cellStyle.left = 0;\r\n        for (let i = 0; i < columnIndex; i += 1) {\r\n          cellStyle.left += this.columns[i].width;\r\n        }\r\n        cellStyle.left += 'px';\r\n      }\r\n      return cellStyle;\r\n    },\r\n\r\n    getGroupClass(level, column, columnIndex) {\r\n      const { level: columnLevel } = column;\r\n      const groupClass = [];\r\n      if (this.setOpenGroupColumns.includes(column.name) && columnLevel === level - 1) {\r\n        groupClass.push('line-start');\r\n      }\r\n      if (level <= columnLevel) groupClass.push('line');\r\n      if (this.isGroupEnd(level, columnIndex) && level <= columnLevel) groupClass.push('line-end');\r\n      return groupClass;\r\n    },\r\n\r\n    getGroupStyle(level) {\r\n      const groupStyle = {};\r\n      if (level === this.maxColumnGroupingLevel) groupStyle['border-bottom'] = 'thin solid grey';\r\n      if (level === 1) groupStyle['border-top'] = 'thin solid rgb(240, 240, 240)';\r\n      return groupStyle;\r\n    },\r\n\r\n    isGroup(column, level) {\r\n      return (Object.keys(column).includes('isGroup')\r\n        && (column.level + 1) === level);\r\n    },\r\n\r\n    isGroupEnd(level, columnIndex) {\r\n      if ((this.columns[columnIndex + 1]?.level !== level)\r\n        && this.columns[columnIndex + 1]?.level <= level - 1) return true;\r\n      return false;\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n@import '../Spread.scss';\r\n.rows {\r\n  position: relative;\r\n  display: grid;\r\n  background-color: $headBackgroundColor;\r\n  .column {\r\n    position: relative;\r\n    display: flex;\r\n    justify-content: center;\r\n    align-items: center;\r\n    // background-color: $headBackgroundColor;\r\n    &-title {\r\n      box-shadow: 1px 0px 0px grey;\r\n      border-bottom: thin solid grey;\r\n    }\r\n    &-group {\r\n      display: flex;\r\n      align-items: flex-end;\r\n      background-color: $headBackgroundColor;\r\n      // padding-bottom: 1px;\r\n    }\r\n    &-end {\r\n      min-width: 20px;\r\n      max-width: 20px;\r\n      box-shadow: 0px 0px 0px grey;\r\n      border-bottom: 0;\r\n    }\r\n  }\r\n  .line-start {\r\n    &::after {\r\n      content: '';\r\n      position: absolute;\r\n      top: 10px;\r\n      right: 0px;\r\n      width: calc(50% - 8px);\r\n      border-bottom: thin solid grey;\r\n    }\r\n  }\r\n  .line {\r\n    &::after {\r\n      content: '';\r\n      position: absolute;\r\n      top: 10px;\r\n      width: 100%;\r\n      border-bottom: thin solid grey;\r\n    }\r\n  }\r\n  .line-end {\r\n    &::after {\r\n      content: '';\r\n      position: absolute;\r\n      top: 10px;\r\n      width: 100%;\r\n      height: 10px;\r\n      border-top: thin solid grey;\r\n      border-bottom: 0;\r\n      border-right: thin solid grey;\r\n    }\r\n  }\r\n}\r\n\r\n</style>\r\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SpreadSheetHead.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SpreadSheetHead.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./SpreadSheetHead.vue?vue&type=template&id=4bd45016&scoped=true&\"\nimport script from \"./SpreadSheetHead.vue?vue&type=script&lang=js&\"\nexport * from \"./SpreadSheetHead.vue?vue&type=script&lang=js&\"\nimport style0 from \"./SpreadSheetHead.vue?vue&type=style&index=0&id=4bd45016&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"4bd45016\",\n  null\n  \n)\n\nexport default component.exports\n\n/* vuetify-loader */\nimport installComponents from \"!../../../../node_modules/vuetify-loader/lib/runtime/installComponents.js\"\nimport { VIcon } from 'vuetify/lib/components/VIcon';\ninstallComponents(component, {VIcon})\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{ref:\"TableBody\",staticClass:\"spread-sheet__body\",on:{\"click\":_vm.evtClickBody,\"dblclick\":_vm.evtDblClickBody,\"keydown\":_vm.evtKeydownBody,\"mousedown\":_vm.evtMousedown}},[_c('tooltip',_vm._b({},'tooltip',_vm.propsTooltip,false)),_c('div',{ref:\"SheetBodyFixed\"}),_c('virtual-list',{ref:\"SheetBody\",staticClass:\"body-virtual\",style:(_vm.styleBody),attrs:{\"wrap-style\":_vm.styleWrapRow,\"keeps\":120,\"data-key\":'value',\"data-sources\":_vm.rows,\"data-component\":_vm.sheetBodyItem,\"extra-props\":_vm.propsItemBody},on:{\"scroll\":_vm.evtScrollList,\"resized\":_vm.evtResizedList}})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('v-tooltip',_vm._b({attrs:{\"right\":\"\",\"content-class\":\"tooltip-box tooltip-box_body\"},on:{\"click\":_vm.evtClose,\"mouseover\":_vm.evtClose},model:{value:(_vm.isShow),callback:function ($$v) {_vm.isShow=$$v},expression:\"isShow\"}},'v-tooltip',_vm.positionTooltip,false),[_vm._v(_vm._s(_vm.text))])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <v-tooltip right\r\n             content-class=\"tooltip-box tooltip-box_body\"\r\n             v-bind=\"positionTooltip\"\r\n             v-model=\"isShow\"\r\n             @click=\"evtClose\"\r\n             @mouseover=\"evtClose\">{{ text }}</v-tooltip>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  name: 'Tooltip',\r\n  props: {\r\n    text: { type: String, default: 'qwe' },\r\n    position: { type: Object, default() { return { left: -100, top: -100 }; } },\r\n    isShow: { type: Boolean, default: false },\r\n  },\r\n  computed: {\r\n    positionTooltip() {\r\n      return {\r\n        'position-x': this.position.left,\r\n        'position-y': this.position.top,\r\n      };\r\n    },\r\n  },\r\n  methods: {\r\n    evtClose() {\r\n      this.$emit('close');\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n</style>\r\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Tooltip.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Tooltip.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Tooltip.vue?vue&type=template&id=467ae553&scoped=true&\"\nimport script from \"./Tooltip.vue?vue&type=script&lang=js&\"\nexport * from \"./Tooltip.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"467ae553\",\n  null\n  \n)\n\nexport default component.exports\n\n/* vuetify-loader */\nimport installComponents from \"!../../../../node_modules/vuetify-loader/lib/runtime/installComponents.js\"\nimport { VTooltip } from 'vuetify/lib/components/VTooltip';\ninstallComponents(component, {VTooltip})\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{key:(\"body-row-\" + _vm.rowName),staticClass:\"sheet-body__row\",style:(_vm.gridRow)},[(_vm.isShowGroup)?_vm._l((_vm.maxRowGroupingLevel),function(level,levelIndex){return _c('div',{key:levelIndex,staticClass:\"column column-group\",class:_vm.getGroupClass(level),style:(_vm.getGroupStyle(level))},[(_vm.isGroup(level))?_c('spread-sheet-btn-group',{attrs:{\"data-row-name\":_vm.rowName}},[_c('v-icon',{attrs:{\"x-small\":\"\",\"color\":\"black\"}},[_vm._v(\" \"+_vm._s(_vm.btnGroup)+\" \")])],1):_vm._e()],1)}):_vm._e(),(_vm.isShowTitle)?_c('div',{staticClass:\"column column-title\",style:(_vm.shiftTitle)},[_c('div',{staticClass:\"content\"},[_vm._v(_vm._s(_vm.rowName))])]):_vm._e(),_vm._l((_vm.columns),function(column,columnIndex){return [(_vm.checkCellExclusion(column.name))?_c('div',{key:(\"body-\" + (_vm.source.value) + \"-\" + (column.value)),staticClass:\"column column-body\",class:_vm.getCellClass(column.name),style:(_vm.getCellStyle(column.name, columnIndex)),attrs:{\"data-name\":_vm.getCellName(column.name),\"data-tooltip\":_vm.getTooltip(column.name),\"tabindex\":columnIndex}},[(_vm.hasImg(column.name))?_c('div',{staticClass:\"content\",domProps:{\"innerHTML\":_vm._s(_vm.getImg(column.name))}}):_c('div',{staticClass:\"content\",class:{'content_tooltip': _vm.hasTooltip(column.name)},domProps:{\"innerHTML\":_vm._s(_vm.formattedData(column.name))}})]):_vm._e()]})],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div :key=\"`body-row-${rowName}`\"\r\n       class=\"sheet-body__row\"\r\n       :style=\"gridRow\">\r\n    <template v-if=\"isShowGroup\">\r\n      <div v-for=\"(level, levelIndex) in maxRowGroupingLevel\"\r\n          class=\"column column-group\"\r\n          :key=\"levelIndex\"\r\n          :class=\"getGroupClass(level)\"\r\n          :style=\"getGroupStyle(level)\">\r\n        <spread-sheet-btn-group v-if=\"isGroup(level)\"\r\n                                :data-row-name=\"rowName\">\r\n          <v-icon x-small color=\"black\">\r\n            {{ btnGroup }}\r\n          </v-icon>\r\n        </spread-sheet-btn-group>\r\n      </div>\r\n    </template>\r\n\r\n    <div v-if=\"isShowTitle\"\r\n          class=\"column column-title\"\r\n          :style=\"shiftTitle\">\r\n      <div class=\"content\">{{ rowName }}</div>\r\n    </div>\r\n\r\n    <template v-for=\"(column, columnIndex) in columns\">\r\n      <div v-if=\"checkCellExclusion(column.name)\"\r\n           :key=\"`body-${source.value}-${column.value}`\"\r\n           class=\"column column-body\"\r\n           :class=\"getCellClass(column.name)\"\r\n           :style=\"getCellStyle(column.name, columnIndex)\"\r\n           :data-name=\"getCellName(column.name)\"\r\n           :data-tooltip=\"getTooltip(column.name)\"\r\n           :tabindex=\"columnIndex\">\r\n        <div v-if=\"hasImg(column.name)\"\r\n             class=\"content\"\r\n             v-html=\"getImg(column.name)\"></div>\r\n        <div v-else\r\n             class=\"content\"\r\n             :class=\"{'content_tooltip': hasTooltip(column.name)}\"\r\n             v-html=\"formattedData(column.name)\"></div>\r\n      </div>\r\n    </template>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport display from '@/plugins/formattingView/formattingView';\r\n\r\nimport {\r\n  CELL_HEIGHT,\r\n  CELL_WIDTH_GROUP,\r\n  CELL_WIDTH_LEFT_GROUP,\r\n  CELL_WIDTH_LEFT_TITLE,\r\n} from '../SpreadSheetConst';\r\nimport SpreadSheetBtnGroup from './SpreadSheetBtnGroup.vue';\r\n\r\nexport default {\r\n  name: 'SpreadSheetBodyItem',\r\n  components: {\r\n    SpreadSheetBtnGroup,\r\n  },\r\n  props: {\r\n    cells: { type: Object, default() { return {}; } },\r\n    columns: Array,\r\n    images: { type: Object, default() { return {}; } },\r\n    index: { type: Number }, // ????\r\n    isShowGroup: { type: Boolean, default: true },\r\n    isShowGrid: { type: Boolean, default: true },\r\n    isShowTitle: { type: Boolean, default: true },\r\n    maxRowGroupingLevel: { type: Number, default: 0 },\r\n    rows: Array, // ????\r\n    setExcludedCells: { type: Array },\r\n    setOpenGroupRows: { type: Array, default() { return []; } },\r\n    setRepresentations: { type: Map, default() { return new Map(); } },\r\n    source: { type: Object, default() { return {}; } }, // is one Row\r\n    templateColumnWidth: { type: String, default: '' },\r\n  },\r\n  data() {\r\n    return {\r\n      rowName: this.source.value,\r\n    };\r\n  },\r\n  computed: {\r\n    btnGroup() {\r\n      return (this.setOpenGroupRows.includes(this.rowName))\r\n        ? 'mdi-minus' : 'mdi-plus';\r\n    },\r\n\r\n    gridRow() {\r\n      const gridRow = {\r\n        'grid-template-rows': `${this.source.height || CELL_HEIGHT}px`,\r\n        'grid-template-columns': this.templateColumnTitle,\r\n      };\r\n      return gridRow;\r\n    },\r\n\r\n    shiftTitle() {\r\n      let shiftLeft = CELL_WIDTH_LEFT_GROUP * this.maxRowGroupingLevel;\r\n      if (this.maxRowGroupingLevel !== 0) shiftLeft += 4;\r\n      const shiftTitle = {\r\n        left: `${shiftLeft}px`,\r\n      };\r\n      if (this.index === 0) shiftTitle['border-top'] = 0;\r\n      if (this.index === this.rows.length - 1) shiftTitle['border-bottom'] = 'thin solid grey';\r\n      return shiftTitle;\r\n    },\r\n\r\n    templateColumnTitle() {\r\n      let tempalteColumnTitle = `${this.templateColumnWidth}`;\r\n      if (this.isShowTitle) tempalteColumnTitle = `${CELL_WIDTH_LEFT_TITLE}px ${tempalteColumnTitle}`;\r\n      if (this.maxRowGroupingLevel !== 0) {\r\n        tempalteColumnTitle = `repeat(${this.maxRowGroupingLevel - 1},\r\n                               minmax(${CELL_WIDTH_GROUP}px, ${CELL_WIDTH_GROUP}px))\r\n                               ${CELL_WIDTH_GROUP + 4}px\r\n                               ${tempalteColumnTitle}`;\r\n      }\r\n      return tempalteColumnTitle;\r\n    },\r\n  },\r\n  methods: {\r\n    checkCellExclusion(columnName) {\r\n      const cellName = this.getCellName(columnName);\r\n      if (this.setExcludedCells.includes(cellName)) return false;\r\n      return true;\r\n    },\r\n\r\n    formattedData(columnName) {\r\n      const cell = this.hasCell(columnName);\r\n      if (!cell) return '';\r\n      if (!Object.keys(cell).includes('value')) return '';\r\n      return display.formate(cell.value, { ...cell, representations: this.setRepresentations });\r\n    },\r\n\r\n    hasCell(columnName) {\r\n      return (this.cells[this.getCellName(columnName)]) || false;\r\n    },\r\n\r\n    hasImg(columnName) {\r\n      return (this.hasCell(columnName)?.image) || false;\r\n    },\r\n\r\n    hasTooltip(columnName) {\r\n      return (this.hasCell(columnName)?.title) || false;\r\n    },\r\n\r\n    isGroup(level) {\r\n      return (Object.keys(this.source).includes('isGroup')\r\n        && (this.source.level + 1) === level);\r\n    },\r\n\r\n    isGroupEnd(level) {\r\n      const indexRow = this.index;\r\n      if ((this.rows[indexRow + 1]?.level !== this.source.level)\r\n        && this.rows[indexRow + 1]?.level <= level - 1) return true;\r\n      return false;\r\n    },\r\n\r\n    getCellClass(columnName) {\r\n      const cellClass = [];\r\n      if (this.hasCell(columnName)) cellClass.push(this.hasCell(columnName).style || '');\r\n      if (!this.isShowGrid) cellClass.push('column-body_grid-off');\r\n      return cellClass;\r\n    },\r\n\r\n    getCellFixed(columnIndex) {\r\n      const cellFixed = {};\r\n      if (this.columns[columnIndex].fixed) {\r\n        cellFixed.position = 'sticky';\r\n        cellFixed['z-index'] = 100;\r\n        cellFixed.left = CELL_WIDTH_LEFT_GROUP * this.maxRowGroupingLevel;\r\n        if (this.isShowTitle) cellFixed.left += CELL_WIDTH_LEFT_TITLE;\r\n        for (let i = 0; i < columnIndex; i += 1) {\r\n          cellFixed.left += this.columns[i].width;\r\n        }\r\n        cellFixed.left += 'px';\r\n        if (!this.columns[columnIndex + 1].fixed\r\n          && !this.isShowGrid) cellFixed['box-shadow'] = '2px 0px 0px rgba(0, 0, 0, .2)';\r\n      }\r\n      return cellFixed;\r\n    },\r\n\r\n    getCellGeometry(columnName, columnIndex) {\r\n      const cellGeometry = {};\r\n      if (this.hasCell(columnName)) {\r\n        const {\r\n          'grid-column-start': columnStart,\r\n          'grid-column-end': columnEnd,\r\n          height,\r\n        } = this.hasCell(columnName);\r\n        cellGeometry['grid-column-start'] = +columnStart + columnIndex;\r\n        cellGeometry['grid-column-end'] = +columnEnd + columnIndex;\r\n        cellGeometry.height = `${height}px`;\r\n      } else {\r\n        cellGeometry['grid-column-start'] = columnIndex + (this.maxRowGroupingLevel + 2);\r\n        cellGeometry['grid-column-end'] = (columnIndex + (this.maxRowGroupingLevel + 2)) + 1;\r\n      }\r\n      if (!this.isShowTitle) {\r\n        cellGeometry['grid-column-start'] -= 1;\r\n        cellGeometry['grid-column-end'] -= 1;\r\n      }\r\n      return cellGeometry;\r\n    },\r\n\r\n    getCellName(columnName) {\r\n      return `${columnName}${this.source.value}`;\r\n    },\r\n\r\n    getCellStyle(columnName, columnIndex) {\r\n      const cellStyle = [];\r\n      cellStyle.push(this.getCellGeometry(columnName, columnIndex));\r\n      cellStyle.push(this.getCellFixed(columnIndex));\r\n      return cellStyle;\r\n    },\r\n\r\n    getGroupClass(level) {\r\n      const { level: rowLevel } = this.source;\r\n      const groupClass = [];\r\n      if (this.setOpenGroupRows.includes(this.rowName) && rowLevel === level - 1) {\r\n        groupClass.push('line-start');\r\n      }\r\n      if (level <= rowLevel) groupClass.push('line');\r\n      if (this.isGroupEnd(level) && level <= rowLevel) groupClass.push('line-end');\r\n      return groupClass;\r\n    },\r\n\r\n    getGroupStyle(level) {\r\n      const groupStyle = {\r\n        left: `${(CELL_WIDTH_LEFT_GROUP * (+level - 1))}px`,\r\n      };\r\n      // if (!this.isShowTitle\r\n      //   && this.maxRowGroupingLevel === level) groupStyle['border-right'] = 'thin solid grey';\r\n      if (this.index === this.rows.length - 1) groupStyle['border-bottom'] = 'thin solid grey';\r\n      if (this.maxRowGroupingLevel === level) {\r\n        console.log('add width');\r\n        groupStyle['border-right'] = 'thin solid grey';\r\n        groupStyle['padding-right'] = '4px';\r\n        groupStyle.width = '25px';\r\n      }\r\n      return groupStyle;\r\n    },\r\n\r\n    getImg(columnName) {\r\n      return this.images[this.hasCell(columnName)?.image];\r\n    },\r\n\r\n    getTooltip(columnName) {\r\n      return this.hasCell(columnName)?.title || '';\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n@import '../SpreadSheet.scss';\r\n\r\n.sheet-body__row {\r\n  position: relative;\r\n  display: grid;\r\n  grid-row: $bodyGridAutoRow;\r\n  // grid-auto-rows: $bodyGridAutoRow;\r\n  box-sizing: border-box;\r\n  .column {\r\n    position: relative;\r\n    display: inline-flex;\r\n    align-items: flex-end;\r\n    &-stop {\r\n      position: sticky;\r\n      top: 0px;\r\n    }\r\n    &-group, &-title {\r\n      position: sticky;\r\n      justify-content: center;\r\n      font-size: 0.75em;\r\n      font-weight: bold;\r\n      color: $bodyFontColorTitle;\r\n      cursor: default;\r\n    }\r\n\r\n    &-group {\r\n      // padding-top: 2px;\r\n      // padding-left: 0px;\r\n      display: flex;\r\n      justify-content: flex-end;\r\n      align-items: center;\r\n      left: 0px;\r\n      width: 100%;\r\n      height: 100%;\r\n      background-color: $backgroundColorTitle;\r\n      // border: thin solid black;\r\n      z-index: 500;\r\n      // &:first-child {\r\n      //   // box-shadow: inset 1px 0px 0px grey;\r\n      //   // border-left: thin solid  grey;\r\n      // }\r\n      &::after {\r\n        position: absolute;\r\n        content: '';\r\n        left: 0px;\r\n        bottom: -1px;\r\n        // top: 0px;\r\n        right: 0px;\r\n        background-color: unset;\r\n        // border-bottom: thin solid grey;\r\n        user-select: none;\r\n        // box-shadow:  inset 0px -1px 0px grey;\r\n      }\r\n    }\r\n\r\n    &-title {\r\n      // padding-top: 1px;\r\n      align-items: center;\r\n      width: 60px;\r\n      z-index: 400;\r\n      border-top: thin solid grey;\r\n      background-color: $backgroundColorTitle;\r\n      &::after {\r\n        content: '';\r\n        position: absolute;\r\n        left: 0px;\r\n        top: 0px;\r\n        right: 0px;\r\n        bottom: -1px;\r\n        // border-left: thin solid grey;\r\n        border-right: thin solid grey;\r\n        // border-bottom: thin solid grey;\r\n        z-index: 401;\r\n      }\r\n      // .content {\r\n      //   display: flex;\r\n      //   justify-content: center;\r\n      //   align-items: center;\r\n      //   height: 100%;\r\n      //   width: 100%;\r\n      //   box-sizing: border-box;\r\n      //   background-color: $backgroundColorTitle;\r\n      //   overflow: hidden;\r\n      //   user-select: none;\r\n      //   z-index: 401;\r\n      // }\r\n    }\r\n    &-body {\r\n      width: 100%;\r\n      box-sizing: border-box;\r\n      line-height: $bodyLineHeight;\r\n      white-space: nowrap;\r\n      outline: none;\r\n      cursor: cell;\r\n      background-color: $backgroundColorBody;\r\n      .content {\r\n        display: flex;\r\n        justify-content: inherit;\r\n        align-items: inherit;\r\n        height: 100%;\r\n        width: 100%;\r\n        padding: 0px 3px;\r\n        overflow: hidden;\r\n        user-select: none;\r\n        &_tooltip {\r\n          content: '';\r\n          position: absolute;\r\n          top: 0px;\r\n          right: 0px;\r\n          width: 10px;\r\n          height: 10px;\r\n          background: linear-gradient(45deg, rgba(0,0,0,0) 65%,#f5a338 50%);\r\n          z-index: 81;\r\n        }\r\n        // &-tooltip_invalid {\r\n        //   background-color: grey;\r\n        // }\r\n      }\r\n      &::after {\r\n        content: '';\r\n        position: absolute;\r\n        left: 0px;\r\n        top: 0px;\r\n        right: -1px;\r\n        bottom: -1px;\r\n        border-right: $bodyGridColor;\r\n        border-bottom: $bodyGridColor;\r\n        z-index: 80;\r\n      }\r\n      &_grid-off {\r\n        &::after {\r\n          content: '';\r\n          position: absolute;\r\n          left: 0px;\r\n          top: 0px;\r\n          right: 0px;\r\n          bottom: -1px;\r\n          border-right: $bodyGridColorOff;\r\n          border-bottom: $bodyGridColorOff;\r\n          z-index: 80;\r\n        }\r\n      }\r\n    }\r\n  }\r\n  .line-start {\r\n    &::before {\r\n      content: '';\r\n      position: absolute;\r\n      // left: 10px;\r\n      width: 9px;\r\n      top: calc(50% + 8px);\r\n      height: 100%;\r\n      border-left: 1px solid grey;\r\n    }\r\n  }\r\n  .line {\r\n    &::before {\r\n      content: '';\r\n      position: absolute;\r\n      // top: 0px;\r\n\r\n      width: 9px;\r\n      height: 100%;\r\n      border-left: 1px solid grey;\r\n    }\r\n  }\r\n  .line-end {\r\n    &::before {\r\n      content: '';\r\n      position: absolute;\r\n      // left: 10px;\r\n      bottom: -1px;\r\n      top: 0px;\r\n      width: 9px;\r\n      height: 100%;\r\n      // border-left: 1px solid #3F3F3F;\r\n      border-bottom: 1px solid grey;\r\n      background-color: unset;\r\n      z-index: 9999;\r\n    }\r\n  }\r\n  .selected {\r\n    &::before {\r\n      content: '';\r\n      position: absolute;\r\n      top: 0px;\r\n      bottom: -1px;\r\n      left: 0px;\r\n      right: -1px;\r\n      border: 1px solid #1a73e8;\r\n      z-index: 199;\r\n    }\r\n  }\r\n}\r\n</style>\r\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SpreadSheetBodyItem.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SpreadSheetBodyItem.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./SpreadSheetBodyItem.vue?vue&type=template&id=0fa756fa&scoped=true&\"\nimport script from \"./SpreadSheetBodyItem.vue?vue&type=script&lang=js&\"\nexport * from \"./SpreadSheetBodyItem.vue?vue&type=script&lang=js&\"\nimport style0 from \"./SpreadSheetBodyItem.vue?vue&type=style&index=0&id=0fa756fa&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"0fa756fa\",\n  null\n  \n)\n\nexport default component.exports\n\n/* vuetify-loader */\nimport installComponents from \"!../../../../node_modules/vuetify-loader/lib/runtime/installComponents.js\"\nimport { VIcon } from 'vuetify/lib/components/VIcon';\ninstallComponents(component, {VIcon})\n","<template>\r\n  <div ref=\"TableBody\"\r\n       class=\"spread-sheet__body\"\r\n       @click=\"evtClickBody\"\r\n       @dblclick=\"evtDblClickBody\"\r\n       @keydown=\"evtKeydownBody\"\r\n       @mousedown=\"evtMousedown\">\r\n    <tooltip v-bind=\"propsTooltip\"></tooltip>\r\n    <div ref=\"SheetBodyFixed\"></div>\r\n    <virtual-list ref=\"SheetBody\"\r\n                  class=\"body-virtual\"\r\n                  :style=\"styleBody\"\r\n                  :wrap-style=\"styleWrapRow\"\r\n                  :keeps=\"120\"\r\n                  :data-key=\"'value'\"\r\n                  :data-sources=\"rows\"\r\n                  :data-component=\"sheetBodyItem\"\r\n                  :extra-props=\"propsItemBody\"\r\n                  @scroll=\"evtScrollList\"\r\n                  @resized=\"evtResizedList\">\r\n    </virtual-list>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport {\r\n  getParseAtSymbolDigit,\r\n} from '@/helpers/spreadSheet';\r\nimport Tooltip from '@/components/Form/Tooltip/Tooltip.vue';\r\nimport SpreadSheetBodyItem from './SpreadSheetBodyItem.vue';\r\n\r\nimport {\r\n  // CELL_WIDTH_TITLE,\r\n  CELL_WIDTH_GROUP,\r\n  CELL_HEIGHT_BODY,\r\n  CELL_HEIGHT_GROUP,\r\n} from '../SpreadSheetConst';\r\n\r\nexport default {\r\n  name: 'SpreadSheetBody',\r\n  components: {\r\n    // SpreadSheetBodyItem,\r\n    Tooltip,\r\n  },\r\n  props: {\r\n    cells: { type: Object },\r\n    columns: { type: Array },\r\n    rows: { type: Array },\r\n    rowsFixed: { type: Array, default() { return []; } },\r\n    tableWidth: { type: Number, default: 0 },\r\n    templateColumnWidth: { type: String, default: '' },\r\n    maxRowGroupingLevel: { type: Number, default: 0 },\r\n    maxColumnGroupingLevel: { type: Number, default: 0 },\r\n    images: { type: Object, default() { return {}; } },\r\n    representations: { type: Map, default() { return new Map(); } },\r\n    setExcludedCells: { type: Object, default() { return {}; } },\r\n    setOpenGroupRows: { type: Array, default() { return []; } },\r\n    isShowGrid: { type: Boolean, default: true },\r\n    isShowTitle: { type: Boolean, default: true },\r\n  },\r\n  data() {\r\n    return {\r\n      sheetBodyItem: SpreadSheetBodyItem,\r\n      propsTooltip: {\r\n        isShow: false,\r\n        position: {\r\n          left: -100,\r\n          top: -100,\r\n        },\r\n      },\r\n      isTooltipTimer: null,\r\n    };\r\n  },\r\n  computed: {\r\n    propsItem() {\r\n      return {\r\n        columns: this.columns,\r\n        rows: this.rows,\r\n        cells: this.cells,\r\n        'set-representations': this.representations,\r\n        'set-excluded-cells': [].concat(...Object.values(this.setExcludedCells)),\r\n        'max-row-grouping-level': this.maxRowGroupingLevel,\r\n        'template-column-width': this.templateColumnWidth,\r\n        'is-show-grid': this.isShowGrid,\r\n        'is-show-title': this.isShowTitle,\r\n      };\r\n    },\r\n\r\n    propsItemBody() {\r\n      return {\r\n        ...this.propsItem,\r\n        'set-open-group-rows': this.setOpenGroupRows,\r\n        images: this.images,\r\n      };\r\n    },\r\n\r\n    styleBody() {\r\n      return [\r\n        this.heightVirtualList,\r\n        this.widthVirtualList,\r\n        {\r\n          'overflow-y': 'auto',\r\n          position: 'relative',\r\n        },\r\n      ];\r\n    },\r\n\r\n    styleWrapRow() {\r\n      return {\r\n        position: 'relative',\r\n        width: `${this.tableWidth}px`,\r\n      };\r\n    },\r\n\r\n    heightVirtualList() {\r\n      let heightBodyFixed = 168 + (this.maxColumnGroupingLevel * (CELL_HEIGHT_GROUP));\r\n      if (this.maxColumnGroupingLevel !== 0) heightBodyFixed += 4;\r\n      // for (let i = 0; i < this.rowsFixed.length; i += 1) {\r\n      //   heightBodyFixed += this.rowsFixed[i].height;\r\n      // }\r\n      if (!this.isShowTitle) heightBodyFixed -= CELL_HEIGHT_BODY;\r\n      return {\r\n        height: `calc(100vh - ${heightBodyFixed}px)`,\r\n      };\r\n    },\r\n\r\n    widthVirtualList() {\r\n      let title = 0;\r\n      if (!this.isShowTitle) title = this.maxLevelGroupRow * CELL_WIDTH_GROUP;\r\n      const width = {\r\n        width: `calc(100vw - 20px + ${title}px)`,\r\n      };\r\n      return width;\r\n    },\r\n  },\r\n  mounted() {\r\n    this.sheetBodyGeometry = this.$refs.SheetBody.$el.getBoundingClientRect();\r\n  },\r\n  methods: {\r\n    evtClickBody(evt) {\r\n      if (evt.target.closest('button')) {\r\n        const rowName = evt.target.closest('button').parentElement.getAttribute('data-row-name');\r\n        this.$emit('open-group:row', +rowName);\r\n        // this.toggleRowGroup(+rowName);\r\n      }\r\n    },\r\n\r\n    evtDblClickBody(evt) {\r\n      if (!evt.target.hasAttribute('data-name')) return;\r\n      const cellName = evt.target.getAttribute('data-name');\r\n      this.$emit('dblclick:cell', { evt, cellName });\r\n    },\r\n\r\n    evtKeydownBody(evt) {\r\n      if (this.isNavigationKey(evt)) return;\r\n      const setTemplateKey = ['Key', 'Numpad', 'Digit', 'Enter', 'Delete', 'Space'];\r\n      if (!setTemplateKey.find((item) => evt.code.includes(item))) return;\r\n\r\n      if (this.isCopyKey(evt) || this.isPasteKey(evt)) return;\r\n      if (evt.ctrlKey) return;\r\n      console.log(evt.target);\r\n      evt.preventDefault();\r\n      if (evt.target.hasAttribute('data-name')) {\r\n        const cellName = evt.target.getAttribute('data-name');\r\n        this.$emit('keydown:cell', { evt, cellName });\r\n      }\r\n    },\r\n\r\n    evtMousedown(evt) {\r\n      if (evt.target.closest('.column-body')) {\r\n        this.selectEnd = null;\r\n        this.selectStart = evt.target;\r\n      }\r\n      const target = evt.target.closest('.column-body');\r\n      if (!target) return;\r\n      if (!target.hasAttribute('data-name')) return;\r\n      const cellName = target.getAttribute('data-name');\r\n      this.$emit('click:cell', { evt, cellName });\r\n      const cell = Object.entries(this.cells).find((item) => item[0] === cellName);\r\n      if (cell) {\r\n        const [, cellValue] = cell;\r\n        const isTrySelected = cellValue.noSelect || false;\r\n        if (isTrySelected) return;\r\n      }\r\n      this.focusCell(this.getCellNodeForName(cellName));\r\n    },\r\n\r\n    evtMouseout() {\r\n      clearTimeout(this.isTooltipTimer);\r\n      if (!this.propsTooltip.isShow) return;\r\n      this.propsTooltip = {\r\n        text: '',\r\n        isShow: false,\r\n        position: {\r\n          left: -100,\r\n          top: -100,\r\n        },\r\n      };\r\n    },\r\n\r\n    evtMouseover(evt) {\r\n      this.isTooltipTimer = setTimeout(() => {\r\n        const titleText = evt.target.closest('.column-body')?.getAttribute('data-tooltip');\r\n        if (titleText) {\r\n          const targetPosition = evt.target.closest('.column-body').getBoundingClientRect();\r\n          this.propsTooltip = {\r\n            text: titleText,\r\n            isShow: true,\r\n            position: {\r\n              left: targetPosition.right,\r\n              top: targetPosition.top,\r\n            },\r\n          };\r\n        }\r\n      }, 300);\r\n    },\r\n\r\n    evtResizedList() {\r\n      if (!this.currentSelectedCellName) return;\r\n      const cellSelectedNode = this.getCellNodeForName(this.currentSelectedCellName);\r\n      if (!cellSelectedNode) return;\r\n      const cellSelectedGeometry = cellSelectedNode.getBoundingClientRect();\r\n      if (cellSelectedGeometry.top > this.sheetBodyGeometry.top - 10\r\n        && cellSelectedGeometry.bottom < this.sheetBodyGeometry.bottom) {\r\n        this.focusCell(cellSelectedNode);\r\n      }\r\n    },\r\n\r\n    evtScrollList(evt) {\r\n      this.selectStart = null;\r\n      this.selectEnd = null;\r\n      // this.$refs.SheetBodyFixed.scrollLeft = evt.target.scrollLeft;\r\n      this.$emit('scroll-body-x', evt.target.scrollLeft);\r\n    },\r\n\r\n    focusCell(target) {\r\n      if (target.getBoundingClientRect().left < this.widthFixedArea) {\r\n        this.$refs.SheetBody.$el.scrollLeft -= (this.widthFixedArea - target.getBoundingClientRect().left) + 5;\r\n        this.$refs.SheetBodyFixed.scrollLeft -= (this.widthFixedArea - target.getBoundingClientRect().left) + 5;\r\n      }\r\n      const geometryVirtualScroll = target.closest('.spread-sheet__body').getBoundingClientRect();\r\n      if (target.getBoundingClientRect().right > geometryVirtualScroll.right) {\r\n        const delta = target.getBoundingClientRect().right - geometryVirtualScroll.right;\r\n        this.$refs.SheetBody.$el.scrollLeft += delta + 17;\r\n        this.$refs.SheetBodyFixed.scrollLeft += delta + 17;\r\n      }\r\n      target.focus();\r\n      this.selectedCell(target.getAttribute('data-name'));\r\n    },\r\n\r\n    getCellNodeForName(cellName) {\r\n      return this.$refs.TableBody.querySelector(`[data-name=\"${cellName}\"]`);\r\n    },\r\n\r\n    getExpectedCellName(target, direction) {\r\n      const currentCellName = target.getAttribute('data-name');\r\n      let { parthDigit: cellRow, parthSymbol: cellColumn } = getParseAtSymbolDigit(currentCellName);\r\n      if (direction === 'next') {\r\n        cellColumn = this.columns[this.columns.findIndex((item) => item.name === cellColumn) + 1].name;\r\n      }\r\n      if (direction === 'previous') {\r\n        cellColumn = this.columns[this.columns.findIndex((item) => item.name === cellColumn) - 1].name;\r\n      }\r\n      if (direction === 'up') {\r\n        cellRow -= 1;\r\n        while (cellRow > 1) {\r\n          if (this.rows.find((row) => row.value === cellRow)\r\n            || this.rowsFixed.find((row) => row.value === cellRow)) break;\r\n          cellRow -= 1;\r\n        }\r\n      }\r\n      if (direction === 'down') {\r\n        cellRow += 1;\r\n        while (cellRow < this.rows[this.rows.length - 1].value) {\r\n          if (this.rows.find((row) => row.value === cellRow)\r\n            || this.rowsFixed.find((row) => row.value === cellRow)) {\r\n            if (!this.setExcludedCells[currentCellName]?.includes(`${cellColumn}${cellRow}`)) {\r\n              break;\r\n            }\r\n          }\r\n          cellRow += 1;\r\n        }\r\n      }\r\n      // console.log(`${cellColumn}${cellRow}`);\r\n      return `${cellColumn}${cellRow}`;\r\n    },\r\n\r\n    getMergedCellName(target, direction) {\r\n      const mergedCellName = Object.entries(this.setExcludedCells)\r\n        .find((item) => item[1].includes(this.getExpectedCellName(target, direction)))[0];\r\n      return mergedCellName;\r\n    },\r\n\r\n    hasElement(target, direction) {\r\n      if (direction === 'previous') {\r\n        if (!target.previousSibling) return false;\r\n        if (target.previousSibling.nodeName === 'DIV'\r\n          && target.previousSibling.closest('.column-title')) return false;\r\n      }\r\n      if (direction === 'next') {\r\n        if (!target.nextSibling) return false;\r\n        if (!target.nextElementSibling) return false;\r\n      }\r\n      if (direction === 'up') {\r\n        if (!target.parentElement.parentElement.previousSibling\r\n          && !target.closest('.sheet-body')?.previousSibling) return false;\r\n      }\r\n      if (direction === 'down') {\r\n        if (!target.parentElement.parentElement.nextSibling\r\n          && !target.closest('.sheet-body-fixed')?.nextSibling) return false;\r\n      }\r\n      return true;\r\n    },\r\n\r\n    isCopyKey(evt) {\r\n      const cellName = evt.target.getAttribute('data-name');\r\n      if (!cellName) return false;\r\n      if (!(evt.ctrlKey && evt.code === 'KeyC')) return false;\r\n      this.$emit('buffer:copy', cellName);\r\n      return true;\r\n    },\r\n\r\n    isNavigationKey(evt) {\r\n      evt.preventDefault();\r\n      if (evt.code === 'ArrowRight' || (evt.code === 'Tab' && !evt.shiftKey)) this.moveCursorNext(evt.target);\r\n      if (evt.code === 'ArrowLeft' || (evt.code === 'Tab' && evt.shiftKey)) this.moveCursorPrevious(evt.target);\r\n      if (evt.code === 'ArrowUp') this.moveCursorUp(evt.target);\r\n      if (evt.code === 'ArrowDown') this.moveCursorDown(evt.target);\r\n      return evt.code.includes('Arrow');\r\n    },\r\n\r\n    isPasteKey(evt) {\r\n      const cellName = evt.target.getAttribute('data-name');\r\n      if (!cellName) return false;\r\n      if (!(evt.ctrlKey && evt.code === 'KeyV')) return false;\r\n      this.$emit('buffer:paste', cellName);\r\n      return true;\r\n    },\r\n\r\n    moveCursorDown(target) {\r\n      if (!this.hasElement(target, 'down')) return false;\r\n      const expectedCellName = this.getExpectedCellName(target, 'down');\r\n      const expectedCell = this.getCellNodeForName(expectedCellName);\r\n      if (expectedCell) {\r\n        this.shiftBodyScrollDown(expectedCell);\r\n        this.focusCell(expectedCell);\r\n        return true;\r\n      }\r\n      const mergedCellName = this.getMergedCellName(target, 'down');\r\n      const mergedCell = this.getCellNodeForName(mergedCellName);\r\n      if (mergedCell) {\r\n        this.shiftBodyScrollDown(mergedCell);\r\n        this.focusCell(mergedCell);\r\n        return true;\r\n      }\r\n      return false;\r\n    },\r\n\r\n    moveCursorNext(target) {\r\n      if (!this.hasElement(target, 'next')) return false;\r\n      if (target.nextSibling.nodeName === 'DIV') {\r\n        this.focusCell(target.nextSibling);\r\n        return true;\r\n      }\r\n      const currentCellName = target.getAttribute('data-name');\r\n      if (this.setExcludedCells[currentCellName]) {\r\n        this.focusCell(target.nextElementSibling);\r\n        return true;\r\n      }\r\n      this.focusCell(this.getCellNodeForName(this.getMergedCellName(target, 'next')));\r\n      return true;\r\n    },\r\n\r\n    moveCursorPrevious(target) {\r\n      if (!this.hasElement(target, 'previous')) return false;\r\n      if (target.previousSibling.nodeName === 'DIV' && target.previousSibling.closest('.column-body')) {\r\n        this.focusCell(target.previousSibling);\r\n        return true;\r\n      }\r\n      this.focusCell(this.getCellNodeForName(this.getMergedCellName(target, 'previous')));\r\n      return true;\r\n    },\r\n\r\n    moveCursorUp(target) {\r\n      if (!this.hasElement(target, 'up')) return false;\r\n      const expectedCellName = this.getExpectedCellName(target, 'up');\r\n      const expectedCell = this.getCellNodeForName(expectedCellName);\r\n      if (expectedCell) {\r\n        this.shiftBodyScrollUp(expectedCell);\r\n        this.focusCell(expectedCell);\r\n        return true;\r\n      }\r\n      const mergedCellName = this.getMergedCellName(target, 'up');\r\n      const mergedCell = this.getCellNodeForName(mergedCellName);\r\n      if (mergedCell) {\r\n        this.shiftBodyScrollUp(mergedCell);\r\n        this.focusCell(mergedCell);\r\n        return true;\r\n      }\r\n      return false;\r\n    },\r\n\r\n    selectedCell(cellName) {\r\n      const cellNode = this.getCellNodeForName(cellName);\r\n      if (cellName === this.currentSelectedCellName) {\r\n        cellNode.classList.add('selected');\r\n        return;\r\n      }\r\n      if (this.currentSelectedCellName && this.getCellNodeForName(this.currentSelectedCellName)) {\r\n        this.getCellNodeForName(this.currentSelectedCellName).classList.remove('selected');\r\n      }\r\n      if (!cellNode) return;\r\n      cellNode.classList.add('selected');\r\n      this.currentSelectedCellName = cellName;\r\n    },\r\n\r\n    shiftBodyScrollDown(currentCell) {\r\n      const bodyBorders = this.$refs.TableBody.getBoundingClientRect();\r\n      const cellBorders = currentCell.getBoundingClientRect();\r\n      if (cellBorders.bottom > bodyBorders.bottom) {\r\n        const delta = cellBorders.bottom - bodyBorders.bottom;\r\n        this.$refs.SheetBody.$el.scrollTop += delta + 18;\r\n      }\r\n    },\r\n\r\n    shiftBodyScrollUp(currentCell) {\r\n      const bodyBorders = this.$refs.TableBody.getBoundingClientRect();\r\n      const cellBorders = currentCell.getBoundingClientRect();\r\n      if (cellBorders.top < bodyBorders.top + 10) {\r\n        const delta = (bodyBorders.top + 10) - cellBorders.top;\r\n        this.$refs.SheetBody.$el.scrollTop -= delta + 12;\r\n      }\r\n    },\r\n  },\r\n};\r\n</script>\r\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SpreadSheetBody.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SpreadSheetBody.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./SpreadSheetBody.vue?vue&type=template&id=0ad86431&\"\nimport script from \"./SpreadSheetBody.vue?vue&type=script&lang=js&\"\nexport * from \"./SpreadSheetBody.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","<template>\r\n  <table-layout padding=\"4px 4px 4px 4px\">\r\n    <div class=\"spread-sheet\"\r\n         :style=\"spreadSheetStyle\">\r\n      <spread-sheet-angle :max-column-grouping-level=\"maxColumnGroupingLevel\"\r\n                          :max-row-grouping-level=\"maxRowGroupingLevel\"\r\n                          :is-show-title=\"isShowTitle\"\r\n                          @open-group:column=\"evtOpenGroupColumn\"\r\n                          @open-group:row=\"evtOpenGroupRow\"></spread-sheet-angle>\r\n      <spread-sheet-head ref=\"SheetHead\"\r\n                         :columns=\"tableColumns\"\r\n                         :template-column-width=\"templateColumnWidth\"\r\n                         :table-width=\"tableWidth\"\r\n                         :max-column-grouping-level=\"maxColumnGroupingLevel\"\r\n                         :set-open-group-columns=\"setOpenGroupColumns\"\r\n                         :is-show-title=\"isShowTitle\"\r\n                         @toggle-group:column=\"toggleColumnGroup\"></spread-sheet-head>\r\n\r\n      <spread-sheet-body ref=\"SpreadSheetBody\"\r\n                         :rows=\"tableRows\"\r\n                         :columns=\"tableColumns\"\r\n                         :cells=\"tableCells\"\r\n                         :representations=\"representations\"\r\n                         :images=\"images\"\r\n                         :template-column-width=\"templateColumnWidth\"\r\n                         :max-row-grouping-level=\"maxRowGroupingLevel\"\r\n                         :max-column-grouping-level=\"maxColumnGroupingLevel\"\r\n                         :set-excluded-cells=\"setExcludedCells\"\r\n                         :table-width=\"tableWidth\"\r\n                         :set-open-group-rows=\"setOpenGroupRows\"\r\n                         :is-show-grid=\"isShowGrid\"\r\n                         :is-show-title=\"isShowTitle\"\r\n                         @click:cell=\"evtClickCell\"\r\n                         @dblclick:cell=\"evtDblclickCell\"\r\n                         @keydown:cell=\"evtKeydownCell\"\r\n                         @buffer:copy=\"evtBufferCopy\"\r\n                         @buffer:paste=\"evtBufferPaste\"\r\n                         @open-group:row=\"toggleRowGroup\"\r\n                         @scroll-body-x=\"scrollBodyX\"></spread-sheet-body>\r\n    </div>\r\n  </table-layout>\r\n</template>\r\n\r\n<script>\r\nimport {\r\n  getColumnNameForNumber,\r\n  getColumnNumberForName,\r\n  getParseAtSymbolDigit,\r\n} from '@/helpers/spreadSheet';\r\n\r\nimport TableLayout from '../TableLayout.vue';\r\nimport SpreadSheetAngle from './component/SpreadSheetAngle.vue';\r\nimport SpreadSheetHead from './component/SpreadSheetHead.vue';\r\nimport SpreadSheetBody from './component/SpreadSheetBody.vue';\r\n\r\nimport {\r\n  CELL_WIDTH_TITLE,\r\n  CELL_WIDTH_GROUP,\r\n  CELL_WIDTH_BODY,\r\n  CELL_HEIGHT_TITLE,\r\n  CELL_HEIGHT_GROUP,\r\n  CELL_HEIGHT_BODY,\r\n} from './SpreadSheetConst';\r\n\r\nexport default {\r\n  name: 'SpreadSheet',\r\n  components: {\r\n    TableLayout,\r\n    SpreadSheetAngle,\r\n    SpreadSheetHead,\r\n    SpreadSheetBody,\r\n  },\r\n  props: {\r\n    cells: { type: Object, default() { return {}; } },\r\n    cellHeight: { type: Number, default: CELL_HEIGHT_BODY },\r\n    cellWidth: { type: Number, default: CELL_WIDTH_BODY },\r\n    columnCount: { type: Number, default: 50 },\r\n    columns: { type: Object, default() { return {}; } },\r\n    rowCount: { type: Number, default: 1000 },\r\n    rows: { type: Object, default() { return {}; } },\r\n    representations: { type: Map, default() { return new Map(); } },\r\n    styles: { type: Array, default() { return []; } },\r\n    images: { type: Object, default() { return {}; } },\r\n    isShowGrid: { type: Boolean, default: true },\r\n    isShowTitle: { type: Boolean, default: true },\r\n  },\r\n  data() {\r\n    return {\r\n      setOpenGroupColumns: [],\r\n      setOpenGroupRows: [],\r\n      setExcludedCells: {},\r\n    };\r\n  },\r\n  computed: {\r\n    maxColumnGroupingLevel() {\r\n      const maxLevelGroup = [0];\r\n      this.prepareColumns.filter((column) => Object.keys(column).includes('level')).forEach((column) => {\r\n        maxLevelGroup.push(column.level);\r\n      });\r\n      const result = (Math.max(...maxLevelGroup) === 0) ? Math.max(...maxLevelGroup) : Math.max(...maxLevelGroup) + 1;\r\n      return result;\r\n    },\r\n\r\n    maxRowGroupingLevel() {\r\n      const maxLevelGroup = [0];\r\n      this.prepareRows.filter((row) => Object.keys(row).includes('level')).forEach((row) => {\r\n        maxLevelGroup.push(row.level);\r\n      });\r\n      const result = (Math.max(...maxLevelGroup) === 0) ? Math.max(...maxLevelGroup) : Math.max(...maxLevelGroup) + 1;\r\n      return result;\r\n    },\r\n\r\n    prepareCells() {\r\n      // console.log('prepare cells');\r\n      const prepareCells = {};\r\n      Object.entries(this.cells).forEach((item) => {\r\n        const [cellName, cellValue] = item;\r\n        const { parthSymbol: cellNameColumn, parthDigit: cellNameRow } = getParseAtSymbolDigit(cellName);\r\n        const cellValueKeys = Object.keys(cellValue);\r\n\r\n        prepareCells[cellName] = { ...cellValue };\r\n        let colspan = 0;\r\n        if (cellValueKeys.includes('colspan')) {\r\n          colspan = cellValue.colspan;\r\n          this.setExcludedCells[cellName] = [];\r\n          for (let i = 1; i < colspan; i += 1) {\r\n            const columnNameNext = getColumnNameForNumber(getColumnNumberForName(cellNameColumn) + i);\r\n            this.setExcludedCells[cellName].push(`${columnNameNext}${cellNameRow}`);\r\n          }\r\n          prepareCells[cellName]['grid-column-start'] = (this.isPrintMode) ? 1 : (this.maxRowGroupingLevel + 2);\r\n          prepareCells[cellName]['grid-column-end'] = ((this.isPrintMode) ? 1 : (this.maxRowGroupingLevel + 2)) + colspan;\r\n        } else {\r\n          prepareCells[cellName]['grid-column-start'] = (this.isPrintMode) ? 1 : (this.maxRowGroupingLevel + 2);\r\n          prepareCells[cellName]['grid-column-end'] = ((this.isPrintMode) ? 1 : (this.maxRowGroupingLevel + 2)) + 1;\r\n        }\r\n\r\n        let cellHeight = (this.rows[`${cellNameRow}`]) ? this.rows[`${cellNameRow}`].height || this.cellHeight : this.cellHeight;\r\n        if (cellValueKeys.includes('rowspan')) {\r\n          if (!Object.keys(this.setExcludedCells).includes(cellName)) this.setExcludedCells[cellName] = [];\r\n          for (let i = 1; i < cellValue.rowspan; i += 1) {\r\n            this.setExcludedCells[cellName].push(`${cellNameColumn}${cellNameRow + i}`);\r\n            if (cellValueKeys.includes('colspan')) {\r\n              colspan = cellValue.colspan;\r\n              for (let j = 1; j < colspan; j += 1) {\r\n                const cellNameColumnNext = getColumnNameForNumber(getColumnNumberForName(cellNameColumn) + j);\r\n                this.setExcludedCells[cellName].push(`${cellNameColumnNext}${cellNameRow + i}`);\r\n              }\r\n            }\r\n            cellHeight += (this.rows[`${cellNameRow + i}`]) ? this.rows[`${cellNameRow + i}`].height || this.cellHeight : this.cellHeight;\r\n          }\r\n        }\r\n        prepareCells[cellName].height = cellHeight;\r\n      });\r\n      // console.log(tableCells);\r\n      return prepareCells;\r\n    },\r\n\r\n    prepareColumns() {\r\n      const prepareColumns = [];\r\n      const columnsKeys = Object.keys(this.columns);\r\n      for (let i = 1; i < this.columnCount + 1; i += 1) {\r\n        const columnName = getColumnNameForNumber(i);\r\n        const columnItem = {\r\n          value: i,\r\n          name: columnName,\r\n          width: this.cellWidth,\r\n          level: 0,\r\n        };\r\n        if (columnsKeys.includes(columnName)) {\r\n          Object.assign(columnItem, { ...this.columns[columnName] });\r\n        }\r\n        prepareColumns.push(columnItem);\r\n      }\r\n      return prepareColumns;\r\n    },\r\n\r\n    prepareRows() {\r\n      const prepareRows = [];\r\n      const rowsKeys = Object.keys(this.rows);\r\n      for (let i = 1; i < this.rowCount + 1; i += 1) {\r\n        const rowItem = {\r\n          value: i,\r\n          height: this.cellHeight,\r\n          level: 0,\r\n        };\r\n        if (rowsKeys.includes(`${i}`)) {\r\n          Object.assign(rowItem, { ...this.rows[i] });\r\n        }\r\n        prepareRows.push(rowItem);\r\n      }\r\n      console.log('prepare row');\r\n      return prepareRows;\r\n    },\r\n\r\n    tableCells() {\r\n      // console.log('table cells');\r\n      return this.prepareCells;\r\n    },\r\n\r\n    tableColumns() {\r\n      const columns = [];\r\n      let showLevel = 0;\r\n      this.prepareColumns.forEach((column) => {\r\n        const { level } = column;\r\n        if (level === showLevel || level < showLevel) {\r\n          columns.push(column);\r\n        }\r\n        if (level < showLevel) showLevel = level;\r\n        if (this.setOpenGroupColumns.includes(column.name)\r\n          && showLevel === level) showLevel = level + 1;\r\n      });\r\n      return columns;\r\n    },\r\n\r\n    tableRows() {\r\n      const rows = [];\r\n      let showLevel = 0;\r\n      this.prepareRows.forEach((row) => {\r\n        const { level, fixed } = row;\r\n        if ((level === showLevel && !fixed)\r\n          || (level < showLevel)) {\r\n          rows.push(row);\r\n        }\r\n        if (level < showLevel) showLevel = level;\r\n        if (this.setOpenGroupRows.includes(row.value)\r\n          && showLevel === level) showLevel = level + 1;\r\n      });\r\n      console.log('table row');\r\n      // console.log(rows);\r\n      return rows;\r\n    },\r\n\r\n    templateColumnWidth() {\r\n      let templateColumnWidth = '';\r\n      for (let i = 0; i < this.tableColumns.length; i += 1) {\r\n        templateColumnWidth += `${this.tableColumns[i].width}px `;\r\n      }\r\n      return templateColumnWidth;\r\n    },\r\n\r\n    tableWidth() {\r\n      let tableWidth = 0;\r\n      this.tableColumns.forEach((item) => {\r\n        tableWidth += item.width;\r\n      });\r\n      return tableWidth;\r\n    },\r\n\r\n    spreadSheetStyle() {\r\n      let titleColumn = CELL_WIDTH_GROUP * this.maxRowGroupingLevel;\r\n      let titleRow = CELL_HEIGHT_GROUP * this.maxColumnGroupingLevel;\r\n      if (this.isShowTitle) {\r\n        titleColumn += CELL_WIDTH_TITLE;\r\n        titleRow += CELL_HEIGHT_TITLE;\r\n      }\r\n      if (this.maxRowGroupingLevel !== 0) titleColumn += (this.isShowTitle) ? 4 : 5;\r\n      if (this.maxColumnGroupingLevel !== 0) titleRow += (this.isShowTitle) ? 5 : 5;\r\n\r\n      const style = {\r\n        'grid-template-rows': `${titleRow}px 1fr`,\r\n        'grid-template-columns': `${titleColumn}px 1fr`,\r\n      };\r\n      return style;\r\n    },\r\n  },\r\n  watch: {\r\n    cells() {\r\n      this.setExcludedCells = {};\r\n    },\r\n    rows() {\r\n      const rowsOpen = Object.entries(this.rows).filter((row) => {\r\n        const [, rowValue] = row;\r\n        return Object.keys(rowValue).includes('isOpen');\r\n      });\r\n      rowsOpen.forEach((row) => {\r\n        const [rowName] = row;\r\n        this.setOpenGroupRows.push(+rowName);\r\n      });\r\n    },\r\n    columns() {\r\n      const columnOpen = Object.entries(this.columns).filter((column) => {\r\n        const [, columnValue] = column;\r\n        return Object.keys(columnValue).includes('isOpen');\r\n      });\r\n      columnOpen.forEach((column) => {\r\n        const [columnName] = column;\r\n        this.setOpenGroupColumns.push(columnName);\r\n      });\r\n    },\r\n    styles() {\r\n      this.updateDocumentStyles();\r\n    },\r\n  },\r\n  mounted() {\r\n    this.updateDocumentStyles();\r\n  },\r\n  beforeDestroy() {\r\n    this.updateDocumentStyles(false);\r\n  },\r\n  methods: {\r\n    evtClickCell(options) {\r\n      this.$emit('click:cell', options);\r\n    },\r\n\r\n    evtDblclickCell(options) {\r\n      this.$emit('dblclick:cell', options);\r\n    },\r\n\r\n    evtKeydownCell(options) {\r\n      this.$emit('keydown:cell', options);\r\n    },\r\n    evtBufferCopy(cellName) {\r\n      this.$emit('buffer:copy', cellName);\r\n    },\r\n    evtBufferPaste(cellName) {\r\n      this.$emit('buffer:paste', cellName);\r\n    },\r\n\r\n    evtOpenGroupColumn(level) {\r\n      const openGroup = [];\r\n      const closeGroup = [];\r\n      this.prepareColumns.forEach((column) => {\r\n        if (Object.keys(column).includes('isGroup')) {\r\n          if (column.level < level - 1) openGroup.push(column.name);\r\n          if (column.level === level - 1) closeGroup.push(column.name);\r\n        }\r\n      });\r\n      this.setOpenGroupColumns = this.setOpenGroupColumns.filter((x) => !closeGroup.includes(x));\r\n      this.setOpenGroupColumns = [...new Set([...this.setOpenGroupColumns, ...openGroup])];\r\n    },\r\n\r\n    evtOpenGroupRow(level) {\r\n      const openGroup = [];\r\n      const closeGroup = [];\r\n      this.prepareRows.forEach((row) => {\r\n        if (Object.keys(row).includes('isGroup')) {\r\n          if (row.level < level - 1) openGroup.push(row.value);\r\n          if (row.level === level - 1) closeGroup.push(row.value);\r\n        }\r\n      });\r\n      // this.prepareRows.forEach((row) => {\r\n      //   if (Object.keys(row).includes('isGroup') && row.level === level - 1) {\r\n      //     closeGroup.push(row.value);\r\n      //   }\r\n      // });\r\n      this.setOpenGroupRows = this.setOpenGroupRows.filter((x) => !closeGroup.includes(x));\r\n      this.setOpenGroupRows = [...new Set([...this.setOpenGroupRows, ...openGroup])];\r\n    },\r\n\r\n    toggleColumnGroup(columnName) {\r\n      if (this.setOpenGroupColumns.includes(columnName)) {\r\n        this.setOpenGroupColumns.splice(this.setOpenGroupColumns.findIndex((item) => item === columnName), 1);\r\n      } else {\r\n        this.setOpenGroupColumns.push(columnName);\r\n      }\r\n    },\r\n\r\n    toggleRowGroup(rowName) {\r\n      if (this.setOpenGroupRows.includes(rowName)) {\r\n        this.setOpenGroupRows.splice(this.setOpenGroupRows.findIndex((item) => item === rowName), 1);\r\n      } else {\r\n        this.setOpenGroupRows.push(rowName);\r\n      }\r\n      console.log(this.setOpenGroupRows);\r\n    },\r\n\r\n    scrollBodyX(scrollLeft) {\r\n      this.$refs.SheetHead.$el.scrollLeft = scrollLeft;\r\n      this.$emit('scroll:body');\r\n    },\r\n\r\n    updateDocumentStyles(create = true) {\r\n      const styles = document.querySelector('head [data-style=\"style-cell\"]');\r\n      if (styles) styles.remove();\r\n      if (create) this.addingDocumentStyles();\r\n    },\r\n\r\n    addingDocumentStyles() {\r\n      let stylesPath = '';\r\n      const prepareStyles = [];\r\n      // stylesPath = ' .spread-sheet .sheet .sheet-body .sheet-body__row ';\r\n      stylesPath = ' .spread-sheet .spread-sheet__body .body-virtual .sheet-body__row ';\r\n      if (this.isPrintMode) {\r\n        stylesPath = '.spread-sheet-print .sheet .sheet-body-print .sheet-body__row ';\r\n      }\r\n      const elementDOMStyle = document.createElement('style');\r\n      let stylesString = '';\r\n      elementDOMStyle.setAttribute('type', 'text/css');\r\n      elementDOMStyle.setAttribute('data-style', 'style-cell');\r\n\r\n      this.styles.forEach((element) => {\r\n        const listKeys = Object.keys(element.list);\r\n        if (listKeys.includes('borderBottom') || listKeys.includes('borderRight')) {\r\n          prepareStyles.push(this.getPseudoBorder(element));\r\n        }\r\n        prepareStyles.push(this.getStyleCell(element));\r\n      });\r\n      // console.log(prepareStyles);\r\n      prepareStyles.forEach((element) => {\r\n        const stylesObject = {};\r\n        Object.entries(element.list).forEach((item) => {\r\n          const [styleName, styleValue] = [...item];\r\n          stylesObject[this.transformStringToKebabCase(styleName)] = styleValue;\r\n        });\r\n        stylesString += `${stylesPath} .${element.name} ${this.transformObjectToStringStyle(stylesObject)}`;\r\n      });\r\n      elementDOMStyle.innerText = `${stylesString} ${(this.isPrintMode) ? '.no-print {display: none !important}}' : ''}`;\r\n      document.querySelector('head').append(elementDOMStyle);\r\n    },\r\n\r\n    getPseudoBorder(style) {\r\n      const pseudoBorder = {\r\n        name: `${style.name}::after`,\r\n        list: {\r\n          content: \"''\",\r\n          position: 'absolute',\r\n          left: '0px',\r\n          top: '-1.4px',\r\n          right: '-1px',\r\n          bottom: '-0.6px',\r\n          'z-index': '80',\r\n        },\r\n      };\r\n      const listKeys = Object.keys(style.list);\r\n      if (listKeys.includes('borderRight')) {\r\n        pseudoBorder.list.borderRight = style.list.borderRight;\r\n        pseudoBorder.list.right = `-${(0.8 * +style.list.borderRight[0])}px`;\r\n      }\r\n      if (listKeys.includes('borderBottom')) {\r\n        pseudoBorder.list.borderBottom = style.list.borderBottom;\r\n        // pseudoBorder.list.bottom = `-${(1 * +style.list.borderBottom[0])}px`;\r\n      }\r\n      if (listKeys.includes('borderLeft')) {\r\n        pseudoBorder.list.left = `-${(1 * +style.list.borderLeft[0])}px`;\r\n      }\r\n      return pseudoBorder;\r\n    },\r\n\r\n    getStyleCell(style) {\r\n      const styleCell = {\r\n        name: style.name,\r\n        list: {},\r\n      };\r\n      Object.entries(style.list).forEach((element) => {\r\n        const [key, value] = element;\r\n        styleCell.list[key] = value;\r\n      });\r\n      if (Object.keys(styleCell.list).includes('borderRight')) delete styleCell.list.borderRight;\r\n      if (Object.keys(styleCell.list).includes('borderBottom')) delete styleCell.list.borderBottom;\r\n      return styleCell;\r\n    },\r\n\r\n    transformStringToKebabCase(styleName) {\r\n      return styleName.replace(/[A-Z]/g, (letter) => `-${letter.toLowerCase()}`);\r\n    },\r\n\r\n    transformObjectToStringStyle(object) {\r\n      return JSON.stringify(object).replace(/\",\"/g, ';').replace(/\"/g, '').replace(/}/g, ';}');\r\n    },\r\n\r\n    // public methods ---------\r\n    newDocument() {\r\n      this.setOpenGroupColumns = [];\r\n      this.setOpenGroupRows = [];\r\n      this.setExcludedCells = {};\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n@import './Spread.scss';\r\n\r\n.spread-sheet {\r\n  display: grid;\r\n  grid-template-areas: \"angle head\" \"body body\";\r\n  height: 100%;\r\n  border: $borderBase;\r\n  &__angle {\r\n    grid-area: angle;\r\n    border-right: thin solid grey;\r\n    border-bottom: thin solid grey;\r\n    background-color: $headBackgroundColor;\r\n    // background: blue;\r\n  }\r\n  &__head {\r\n    grid-area: head;\r\n    font-size: $headFontSize;\r\n    font-weight: $headFontWeight;\r\n    color: $headFontColor;\r\n    background-color: $headBackgroundColor;\r\n    overflow: hidden;\r\n    &_bottom-line {\r\n      border-bottom: thin solid grey;\r\n    }\r\n  }\r\n  &__body {\r\n    grid-area: body;\r\n    // background: cadetblue;\r\n  }\r\n}\r\n</style>\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SpreadSheet.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SpreadSheet.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./SpreadSheet.vue?vue&type=template&id=1cbcd236&scoped=true&\"\nimport script from \"./SpreadSheet.vue?vue&type=script&lang=js&\"\nexport * from \"./SpreadSheet.vue?vue&type=script&lang=js&\"\nimport style0 from \"./SpreadSheet.vue?vue&type=style&index=0&id=1cbcd236&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"1cbcd236\",\n  null\n  \n)\n\nexport default component.exports","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TableLayout.vue?vue&type=style&index=0&id=7b82dcc5&lang=scss&scoped=true&\"","export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SpreadSheetHead.vue?vue&type=style&index=0&id=4bd45016&lang=scss&scoped=true&\"","export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SpreadSheetBodyItem.vue?vue&type=style&index=0&id=0fa756fa&lang=scss&scoped=true&\"","export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SpreadSheetBtnGroup.vue?vue&type=style&index=0&id=8eb8881a&lang=scss&scoped=true&\"","export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SpreadSheetAngle.vue?vue&type=style&index=0&id=6991d391&lang=scss&scoped=true&\""],"sourceRoot":""}